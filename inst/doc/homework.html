<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Jiaqiang Li" />

<meta name="date" content="2022-11-29" />

<title>Homework summary by 22003</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<script>$(document).ready(function(){
    if (typeof $('[data-toggle="tooltip"]').tooltip === 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }
    if ($('[data-toggle="popover"]').popover === 'function') {
        $('[data-toggle="popover"]').popover();
    }
});
</script>
<style type="text/css">
.lightable-minimal {
border-collapse: separate;
border-spacing: 16px 1px;
width: 100%;
margin-bottom: 10px;
}
.lightable-minimal td {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal th {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal thead tr:last-child th {
border-bottom: 2px solid #00000050;
empty-cells: hide;
}
.lightable-minimal tbody tr:first-child td {
padding-top: 0.5em;
}
.lightable-minimal.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-minimal.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic {
border-top: 0.16em solid #111111;
border-bottom: 0.16em solid #111111;
width: 100%;
margin-bottom: 10px;
margin: 10px 5px;
}
.lightable-classic tfoot tr td {
border: 0;
}
.lightable-classic tfoot tr:first-child td {
border-top: 0.14em solid #111111;
}
.lightable-classic caption {
color: #222222;
}
.lightable-classic td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic thead tr:last-child th {
border-bottom: 0.10em solid #111111;
}
.lightable-classic.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic-2 {
border-top: 3px double #111111;
border-bottom: 3px double #111111;
width: 100%;
margin-bottom: 10px;
}
.lightable-classic-2 tfoot tr td {
border: 0;
}
.lightable-classic-2 tfoot tr:first-child td {
border-top: 3px double #111111;
}
.lightable-classic-2 caption {
color: #222222;
}
.lightable-classic-2 td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic-2 th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic-2 tbody tr:last-child td {
border-bottom: 3px double #111111;
}
.lightable-classic-2 thead tr:last-child th {
border-bottom: 1px solid #111111;
}
.lightable-classic-2.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic-2.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #EEE;
border-collapse: collapse;
margin-bottom: 10px;
}
.lightable-material tfoot tr td {
border: 0;
}
.lightable-material tfoot tr:first-child td {
border-top: 1px solid #EEE;
}
.lightable-material th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
}
.lightable-material td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
border-top: 1px solid #eeeeee;
}
.lightable-material.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody td {
border: 0;
}
.lightable-material.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #ddd;
}
.lightable-material-dark {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #FFFFFF12;
border-collapse: collapse;
margin-bottom: 10px;
background-color: #363640;
}
.lightable-material-dark tfoot tr td {
border: 0;
}
.lightable-material-dark tfoot tr:first-child td {
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF60;
}
.lightable-material-dark td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF;
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark.lightable-hover tbody tr:hover {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody tr:nth-child(even) {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody td {
border: 0;
}
.lightable-material-dark.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #FFFFFF12;
}
.lightable-paper {
width: 100%;
margin-bottom: 10px;
color: #444;
}
.lightable-paper tfoot tr td {
border: 0;
}
.lightable-paper tfoot tr:first-child td {
border-top: 1px solid #00000020;
}
.lightable-paper thead tr:last-child th {
color: #666;
vertical-align: bottom;
border-bottom: 1px solid #00000020;
line-height: 1.15em;
padding: 10px 5px;
}
.lightable-paper td {
vertical-align: middle;
border-bottom: 1px solid #00000010;
line-height: 1.15em;
padding: 7px 5px;
}
.lightable-paper.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-paper.lightable-striped tbody tr:nth-child(even) {
background-color: #00000008;
}
.lightable-paper.lightable-striped tbody td {
border: 0;
}
</style>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework summary by 22003</h1>
<h4 class="author">Jiaqiang Li</h4>
<h4 class="date">2022-11-29</h4>



<div id="hw0-0909" class="section level2">
<h2>HW0-0909</h2>
<div id="question" class="section level3">
<h3>Question</h3>
<p>Use knitr to produce at least 3 examples (texts, figures,
tables).</p>
</div>
<div id="answer" class="section level3">
<h3>Answer</h3>
<p>First we see how to to show a picture.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Then let we see how to show table using knitr. We show the last six
lines in Freedman data set.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data_now <span class="ot">&lt;-</span> carData<span class="sc">::</span>Freedman</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">tail</span>(data_now),<span class="at">format =</span> <span class="st">&quot;html&quot;</span>,<span class="at">caption=</span><span class="st">&quot;Table1: Freeedman Dataset&quot;</span>)</span></code></pre></div>
<table>
<caption>
Table1: Freeedman Dataset
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
population
</th>
<th style="text-align:right;">
nonwhite
</th>
<th style="text-align:right;">
density
</th>
<th style="text-align:right;">
crime
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Wichita
</td>
<td style="text-align:right;">
406
</td>
<td style="text-align:right;">
5.8
</td>
<td style="text-align:right;">
166
</td>
<td style="text-align:right;">
2532
</td>
</tr>
<tr>
<td style="text-align:left;">
Wilkes
</td>
<td style="text-align:right;">
340
</td>
<td style="text-align:right;">
0.3
</td>
<td style="text-align:right;">
383
</td>
<td style="text-align:right;">
613
</td>
</tr>
<tr>
<td style="text-align:left;">
Wilmington
</td>
<td style="text-align:right;">
488
</td>
<td style="text-align:right;">
11.7
</td>
<td style="text-align:right;">
419
</td>
<td style="text-align:right;">
2393
</td>
</tr>
<tr>
<td style="text-align:left;">
Worcester
</td>
<td style="text-align:right;">
612
</td>
<td style="text-align:right;">
0.9
</td>
<td style="text-align:right;">
405
</td>
<td style="text-align:right;">
2874
</td>
</tr>
<tr>
<td style="text-align:left;">
York
</td>
<td style="text-align:right;">
316
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:right;">
220
</td>
<td style="text-align:right;">
1062
</td>
</tr>
<tr>
<td style="text-align:left;">
Youngstown
</td>
<td style="text-align:right;">
528
</td>
<td style="text-align:right;">
9.2
</td>
<td style="text-align:right;">
513
</td>
<td style="text-align:right;">
1698
</td>
</tr>
</tbody>
</table>
<p>Furthermore, we can use the package kableExtra to make our table more
beautiful.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>table2 <span class="ot">&lt;-</span> knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">tail</span>(data_now),<span class="at">format =</span> <span class="st">&quot;html&quot;</span>,<span class="at">caption=</span><span class="st">&quot;Table2: Freeedman Dataset&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>table2 <span class="ot">&lt;-</span> kableExtra<span class="sc">::</span><span class="fu">row_spec</span>(table2,<span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">background =</span> <span class="st">&quot;#696969&quot;</span> ) </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the fill method of the header</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>table2 <span class="ot">&lt;-</span> kableExtra<span class="sc">::</span><span class="fu">column_spec</span>(table2,<span class="dv">5</span>,<span class="at">color=</span><span class="fu">ifelse</span>(data_now<span class="sc">$</span>crime[<span class="dv">105</span><span class="sc">:</span><span class="dv">110</span>]<span class="sc">&gt;</span><span class="dv">2500</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;black&quot;</span>),<span class="at">bold=</span>data_now<span class="sc">$</span>crime[<span class="dv">105</span><span class="sc">:</span><span class="dv">110</span>]<span class="sc">&gt;</span><span class="dv">2500</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Bold the number of crimes greater than 2500 in red</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(table2,<span class="at">bootstrap_options =</span> <span class="st">&quot;bordered&quot;</span>,<span class="at">full_width =</span> F,<span class="at">font_size=</span><span class="dv">20</span>)</span></code></pre></div>
<table class="table table-bordered" style="font-size: 20px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Table2: Freeedman Dataset
</caption>
<thead>
<tr>
<th style="text-align:left;color: white !important;background-color: #696969 !important;">
</th>
<th style="text-align:right;color: white !important;background-color: #696969 !important;">
population
</th>
<th style="text-align:right;color: white !important;background-color: #696969 !important;">
nonwhite
</th>
<th style="text-align:right;color: white !important;background-color: #696969 !important;">
density
</th>
<th style="text-align:right;color: white !important;background-color: #696969 !important;">
crime
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Wichita
</td>
<td style="text-align:right;">
406
</td>
<td style="text-align:right;">
5.8
</td>
<td style="text-align:right;">
166
</td>
<td style="text-align:right;font-weight: bold;color: red !important;">
2532
</td>
</tr>
<tr>
<td style="text-align:left;">
Wilkes
</td>
<td style="text-align:right;">
340
</td>
<td style="text-align:right;">
0.3
</td>
<td style="text-align:right;">
383
</td>
<td style="text-align:right;color: black !important;">
613
</td>
</tr>
<tr>
<td style="text-align:left;">
Wilmington
</td>
<td style="text-align:right;">
488
</td>
<td style="text-align:right;">
11.7
</td>
<td style="text-align:right;">
419
</td>
<td style="text-align:right;color: black !important;">
2393
</td>
</tr>
<tr>
<td style="text-align:left;">
Worcester
</td>
<td style="text-align:right;">
612
</td>
<td style="text-align:right;">
0.9
</td>
<td style="text-align:right;">
405
</td>
<td style="text-align:right;font-weight: bold;color: red !important;">
2874
</td>
</tr>
<tr>
<td style="text-align:left;">
York
</td>
<td style="text-align:right;">
316
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:right;">
220
</td>
<td style="text-align:right;color: black !important;">
1062
</td>
</tr>
<tr>
<td style="text-align:left;">
Youngstown
</td>
<td style="text-align:right;">
528
</td>
<td style="text-align:right;">
9.2
</td>
<td style="text-align:right;">
513
</td>
<td style="text-align:right;color: black !important;">
1698
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use bootstrap_options=&quot;bordered&quot; to set borders for the table</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># &quot;full_width=F&quot; contols the table&#39;s width such that it won&#39;t fill the whole page</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># We can use font_size to set the font size in table</span></span></code></pre></div>
<p>Finally, we use “cat” to output texts and use summary to see Freedman
dataset.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Freedman Summary</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>Freedman Summary</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">summary</span>(data_now))</span></code></pre></div>
<table style="width:94%;">
<colgroup>
<col width="25%" />
<col width="22%" />
<col width="23%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">population</th>
<th align="center">nonwhite</th>
<th align="center">density</th>
<th align="center">crime</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Min. : 270.0</td>
<td align="center">Min. : 0.30</td>
<td align="center">Min. : 37.0</td>
<td align="center">Min. : 458</td>
</tr>
<tr class="even">
<td align="center">1st Qu.: 398.8</td>
<td align="center">1st Qu.: 3.40</td>
<td align="center">1st Qu.: 266.5</td>
<td align="center">1st Qu.:2067</td>
</tr>
<tr class="odd">
<td align="center">Median : 664.0</td>
<td align="center">Median : 7.20</td>
<td align="center">Median : 412.0</td>
<td align="center">Median :2698</td>
</tr>
<tr class="even">
<td align="center">Mean : 1136.0</td>
<td align="center">Mean :10.80</td>
<td align="center">Mean : 765.7</td>
<td align="center">Mean :2714</td>
</tr>
<tr class="odd">
<td align="center">3rd Qu.: 1167.8</td>
<td align="center">3rd Qu.:14.88</td>
<td align="center">3rd Qu.: 773.2</td>
<td align="center">3rd Qu.:3305</td>
</tr>
<tr class="even">
<td align="center">Max. :11551.0</td>
<td align="center">Max. :64.30</td>
<td align="center">Max. :13087.0</td>
<td align="center">Max. :5441</td>
</tr>
<tr class="odd">
<td align="center">NA’s :10</td>
<td align="center">NA</td>
<td align="center">NA’s :10</td>
<td align="center">NA</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We can also use pander to show tables.</span></span></code></pre></div>
</div>
</div>
<div id="hw1-0915" class="section level2">
<h2>HW1-0915</h2>
<div id="question-1" class="section level3">
<h3>Question</h3>
<p>The Pareto(a, b) distribution has cdf</p>
<p><span class="math display">\[F(x)=1-(\frac{b}{x})^a,\quad x\geq
b&gt;0,a&gt;0\]</span> Derive the probability inverse transformation
<span class="math inline">\(F^{-1}(U)\)</span> and use the inverse
transform method to simulate a random sample from the Pareto(2, 2)
distribution. Graph the density histogram of the sample with the
Pareto(2, 2) density superimposed for comparison.</p>
</div>
<div id="answer-1" class="section level3">
<h3>Answer</h3>
<p>By definition,</p>
<p><span class="math display">\[
F^{-1}(y)=\inf\{x|F(x)\geq y\}=\inf\{x\geq b|1-(\frac{b}{x})^a\geq
y\}=\frac{b}{(1-y)^{1/a}},
\]</span> so that <span class="math inline">\(F^{-1}(U)=\frac{b}{(1-U)^{1/a}}\)</span>, where
<span class="math inline">\(U\sim U[0,1]\)</span>. We generate 1000
points from Pareto(2,2) using the inverse transorm method.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>) </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n=</span><span class="dv">5000</span>,<span class="at">min=</span><span class="dv">0</span>,<span class="at">max=</span><span class="dv">1</span>) <span class="co"># generate U</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>pareto <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>u)          <span class="co"># generate Pareto(2,2)</span></span></code></pre></div>
<p>We graph the density histogram of the sample as below. Besides, we
know that Pareto(2,2) has density <span class="math inline">\(f(x)=\frac{16}{x^3}1(x\geq 2)\)</span>. We graph
this density using red lines in the picture.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(pareto,<span class="at">probability =</span> T,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">60</span>),<span class="at">breaks =</span> <span class="dv">100</span>,<span class="at">main=</span><span class="st">&quot;Pareto(2,2)&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;x&quot;</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">60</span>,<span class="at">length.out=</span><span class="dv">1000</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="dv">16</span><span class="sc">/</span>x<span class="sc">^</span><span class="dv">3</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>) <span class="co"># line the density of Pareto(2,2)</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>,<span class="at">legend =</span> <span class="st">&quot;real density&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">lty=</span><span class="dv">1</span>,<span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The histogram is consistent with the real density.</p>
</div>
<div id="question-2" class="section level3">
<h3>Question</h3>
<p>Write a function to generate a random sample of size n from the
Beta(a, b) distribution by the acceptance-rejection method. Generate a
random sample of size 1000 from the Beta(3,2) distribution. Graph the
histogram of the sample with the theoretical Beta(3,2) density
superimposed.</p>
</div>
<div id="answer-2" class="section level3">
<h3>Answer</h3>
<p>The density of Beta(a,b) is</p>
<p><span class="math display">\[f_{ab}(x)=\frac{1}{B(a,b)}x^a(1-x)^b\leq
\frac{1}{B(a,b)},\quad 0&lt;x&lt;1,\]</span> We can take <span class="math inline">\(g(y)=1(0&lt;y&lt;1)\)</span> and <span class="math inline">\(c=B(a,b)^{-1}\)</span> such that <span class="math inline">\(f_{ab}(x)\leq cg(x)\)</span>. We generate
Beta(a,b) as following:</p>
<div class="line-block"> Generate <span class="math inline">\(U,Y \sim
U(0,1)\)</span>;<br />
 Compute <span class="math inline">\(\rho(Y)=\frac{f_{ab}(Y)}{cg(Y)}\)</span>;<br />
 If <span class="math inline">\(U\leq \rho(Y)\)</span> return <span class="math inline">\(X=Y\)</span>,<br />
 otherwise reject <span class="math inline">\(Y\)</span> and
continue.</div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gen_beta generate samples from Beta(a,b) using the acceptance-rejection method</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>gen_beta <span class="ot">&lt;-</span> <span class="cf">function</span>(a,b,n){</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># a,b the parameters of B(a,b)</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># n the number of samples</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  count <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">beta</span>(a,b)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(count <span class="sc">&lt;</span> n){</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="co"># random variable from g(.)</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(y<span class="sc">^</span>a<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y)<span class="sc">^</span>b <span class="sc">&gt;=</span> u){</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>      <span class="co"># accept y</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>      count<span class="ot">&lt;-</span>count<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>      x[count] <span class="ot">&lt;-</span> y</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now let we generate 1000 samples from the Beta(3,2).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>beta_user <span class="ot">&lt;-</span> <span class="fu">gen_beta</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1000</span>)</span></code></pre></div>
<p>Then we graph the histogram of the sample with its density
superimposed. We can find that the histogram is consistent with the real
density.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(beta_user,<span class="at">main=</span><span class="st">&quot;Beta(3,2)&quot;</span>,<span class="at">probability =</span> T,<span class="at">breaks =</span> <span class="dv">12</span>,<span class="at">xlab=</span><span class="st">&quot;x&quot;</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">length.out=</span><span class="dv">1000</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">/</span><span class="fu">beta</span>(<span class="dv">3</span>,<span class="dv">2</span>),<span class="at">col=</span><span class="st">&quot;red&quot;</span>) <span class="co"># line the density of Beta(3,2)</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="at">legend =</span> <span class="st">&quot;real density&quot;</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">lty=</span><span class="dv">1</span>,<span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3" class="section level3">
<h3>Question</h3>
<p>Simulate a continuous Exponential-Gamma mixture. Suppose that the
rate parameter <span class="math inline">\(\Lambda\)</span> has <span class="math inline">\(Gamma(r, \beta)\)</span> distribution and <span class="math inline">\(Y\)</span> has <span class="math inline">\(Exp(\Lambda)\)</span> distribution. That is, <span class="math inline">\((Y |\Lambda = \lambda) ∼ f_Y (y|\lambda) = \lambda
e^{−\lambda y}\)</span>. Generate 1000 random observations from this
mixture with <span class="math inline">\(r = 4\)</span> and <span class="math inline">\(\beta = 2\)</span>.</p>
</div>
<div id="answer-3" class="section level3">
<h3>Answer</h3>
<p>We write a function ‘gen_expgamma’ to generate a continuous
Exponential-Gamma mixture.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>gen_expgamma <span class="ot">&lt;-</span> <span class="cf">function</span>(r,b,n){</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># r,b the parameter of lambda</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># n the size of samples</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n,r,b) <span class="co"># generate lambda from Gamma(r,b) </span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="cf">function</span>(i) <span class="fu">rexp</span>(<span class="dv">1</span>,lambda[i])) <span class="co"># generate Y</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate samples</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>expg_user <span class="ot">&lt;-</span> <span class="fu">gen_expgamma</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">1000</span>)</span></code></pre></div>
<p>Let we have a look at its distribution through histogram.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(expg_user,<span class="at">probability  =</span> T,<span class="at">xlab=</span><span class="st">&quot;x&quot;</span>,<span class="at">main=</span><span class="st">&quot;Histogram of Exponential-Gamma mixture&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-4" class="section level3">
<h3>Question</h3>
<p>Compare the performance of the Beta generator of Exercise 3.7,
Example 3.8 and the R generator rbeta. Fix the parameters a = 2, b = 2
and time each generator on 1000 iterations with sample size 5000. (See
Example 3.19.) Are the results different for different choices of a and
b?</p>
</div>
<div id="answer-4" class="section level3">
<h3>Answer</h3>
<p>We write a function ‘gen_beta_byg’ to generate Beta(a,b) as Example
3.8.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>gen_beta_byg <span class="ot">&lt;-</span> <span class="cf">function</span>(a,b,n){</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n,a,<span class="dv">1</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n,b,<span class="dv">1</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> u<span class="sc">/</span>(u<span class="sc">+</span>v)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Then let we compare the performance of ‘gen_beta’ (in Excercise
3.7),‘gen_beta_byg’ and ‘rbeta’ with a=2,b=2. We time each generator on
1000 iterations with sample size 5000.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># sample size</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>rep <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># iterations</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span>b<span class="ot">&lt;-</span><span class="dv">2</span> <span class="co"># parameters</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rep)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gen_beta</span>(a,b,n))</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rep)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gen_beta_byg</span>(a,b,n))</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>t3 <span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rep)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbeta</span>(n,a,b))</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>m22 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(t1,t2,t3),<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">byrow=</span>T)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(m22) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;beta_accept_reject&quot;</span>,<span class="st">&quot;beta_from_gamma&quot;</span>,<span class="st">&quot;rbeta&quot;</span>)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(m22) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;user&quot;</span>, <span class="st">&quot;system&quot;</span>, <span class="st">&quot;elapsed&quot;</span>)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(m22,<span class="at">caption =</span> <span class="st">&quot;a=2,b=2&quot;</span>)</span></code></pre></div>
<table>
<caption>
a=2,b=2
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
user
</th>
<th style="text-align:right;">
system
</th>
<th style="text-align:right;">
elapsed
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
beta_accept_reject
</td>
<td style="text-align:right;">
8.15
</td>
<td style="text-align:right;">
1.57
</td>
<td style="text-align:right;">
9.72
</td>
</tr>
<tr>
<td style="text-align:left;">
beta_from_gamma
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.03
</td>
</tr>
<tr>
<td style="text-align:left;">
rbeta
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.03
</td>
</tr>
</tbody>
</table>
<p>We can find ‘rbeta’ is the fastest generator. And accept-reject is
much slower than the other method, which is expected since the loop in R
is very slow. Moreover, the acceptance rate is less than 1, meaning that
we need to do more cycles in each iteration.</p>
<p>Let we consider the following two cases: a=3,b=2 and a=2,b=1. Their
acceptance rates are 0.083 and 0.5. And the acceptance rates for
Beta(2,2) is 0.167. So we can find that accept-reject method in
Beat(3,2) is slower than it in Beta(2,2). And accept-reject method in
Beat(2,1) is faster than it in Beta(2,2). Although accept-reject method
is the slowest method in all cases.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rep)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gen_beta</span>(a,b,n))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rep)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gen_beta_byg</span>(a,b,n))</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>t3 <span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rep)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbeta</span>(n,a,b))</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>m32 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(t1,t2,t3),<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">byrow=</span>T)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(m32) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;beta_accept_reject&quot;</span>,<span class="st">&quot;beta_from_gamma&quot;</span>,<span class="st">&quot;rbeta&quot;</span>)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(m32) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;user&quot;</span>, <span class="st">&quot;system&quot;</span>, <span class="st">&quot;elapsed&quot;</span>)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(m32,<span class="at">caption =</span> <span class="st">&quot;a=3,b=2&quot;</span>)</span></code></pre></div>
<table>
<caption>
a=3,b=2
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
user
</th>
<th style="text-align:right;">
system
</th>
<th style="text-align:right;">
elapsed
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
beta_accept_reject
</td>
<td style="text-align:right;">
16.03
</td>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:right;">
16.48
</td>
</tr>
<tr>
<td style="text-align:left;">
beta_from_gamma
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.02
</td>
</tr>
<tr>
<td style="text-align:left;">
rbeta
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rep)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gen_beta</span>(a,b,n))</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rep)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gen_beta_byg</span>(a,b,n))</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>t3 <span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rep)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbeta</span>(n,a,b))</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>m21 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(t1,t2,t3),<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">byrow=</span>T)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(m21) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;beta_accept_reject&quot;</span>,<span class="st">&quot;beta_from_gamma&quot;</span>,<span class="st">&quot;rbeta&quot;</span>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(m21) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;user&quot;</span>, <span class="st">&quot;system&quot;</span>, <span class="st">&quot;elapsed&quot;</span>)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(m21,<span class="at">caption =</span> <span class="st">&quot;a=2,b=1&quot;</span>)</span></code></pre></div>
<table>
<caption>
a=2,b=1
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
user
</th>
<th style="text-align:right;">
system
</th>
<th style="text-align:right;">
elapsed
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
beta_accept_reject
</td>
<td style="text-align:right;">
3.19
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
3.20
</td>
</tr>
<tr>
<td style="text-align:left;">
beta_from_gamma
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.01
</td>
</tr>
<tr>
<td style="text-align:left;">
rbeta
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.02
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="hw2-0923" class="section level2">
<h2>HW2-0923</h2>
<div id="fast-sorting" class="section level3">
<h3>Fast sorting</h3>
<p><strong>Problem.</strong></p>
<p><span class="math inline">\(\cdot\)</span> For <span class="math inline">\(n=10^4,2\times 10^4,4\times 10^4,6\times 10^4,
8\times 10^4,\)</span> apply the fast sorting algorithm to randomly
permuted numbers of <span class="math inline">\(1,\dots,n.\)</span></p>
<p><span class="math inline">\(\cdot\)</span> Calculate computation time
averaged over 100 simulations, denoted by <span class="math inline">\(a_n\)</span>.</p>
<p><span class="math inline">\(\cdot\)</span> Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n:=n\log n\)</span>, and graphically show the
results (scater plot and regression line).</p>
<p><strong>Solution.</strong> We implement fast sorting using the
function ‘quick_sort’ from Professor Zhang’s slides.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>quick_sort<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sorting function</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  num<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(num<span class="sc">==</span><span class="dv">0</span><span class="sc">||</span>num<span class="sc">==</span><span class="dv">1</span>){<span class="fu">return</span>(x)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    a<span class="ot">&lt;-</span>x[<span class="dv">1</span>]</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">&lt;-</span>x[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    lower<span class="ot">&lt;-</span>y[y<span class="sc">&lt;</span>a]</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    upper<span class="ot">&lt;-</span>y[y<span class="sc">&gt;=</span>a]</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">quick_sort</span>(lower),a,<span class="fu">quick_sort</span>(upper)))} <span class="co"># Recursion</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>sample_num <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1e4</span>,<span class="fl">2e4</span>,<span class="fl">4e4</span>,<span class="fl">6e4</span>,<span class="fl">8e4</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>simu_sort <span class="ot">&lt;-</span> <span class="cf">function</span>(i){</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># simulation function</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(i)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  time <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="cf">function</span>(j) <span class="fu">system.time</span>(<span class="fu">quick_sort</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>sample_num[j])))[<span class="dv">1</span>])</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(time)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate computation time averaged over 100 simulations</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,simu_sort)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>an <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(times)</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(an)<span class="ot">&lt;-</span><span class="fu">as.character</span>(sample_num)</span></code></pre></div>
<p>Then let we look the relations ship between the time and sample
numbers. The red line is the regression line.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>tn <span class="ot">&lt;-</span> sample_num<span class="sc">*</span><span class="fu">log</span>(sample_num)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(an<span class="sc">~</span>tn,<span class="at">data=</span><span class="fu">data.frame</span>(tn,an)) <span class="co"># linear regression</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># scatter plot and regressino line</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tn,an,<span class="at">xlab=</span><span class="st">&quot;nlog(n)&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;time:a_n&quot;</span>,<span class="at">main=</span><span class="st">&quot;Sorting time-sample numbers&quot;</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span>reg<span class="sc">$</span>coefficients[<span class="dv">1</span>],<span class="at">b=</span>reg<span class="sc">$</span>coefficients[<span class="dv">2</span>],<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can find that <span class="math display">\[a_n \propto
n\log{n}\]</span></p>
</div>
<div id="exercise-5.6" class="section level3">
<h3>Exercise 5.6</h3>
<p><strong>Problem.</strong> In Example 5.7 the control variate approach
was illustrated for Monte Carlo integration of</p>
<p><span class="math display">\[\theta = \int_0^1 e^x dx\]</span></p>
<p>Now consider the antithetic variate approach. Compute <span class="math inline">\(\operatorname{Cov}(e^U, e^{1−U})\)</span> and
<span class="math inline">\(\operatorname{Var}(e^U+e^{1−U})\)</span>,
where <span class="math inline">\(U\sim
\operatorname{Uniform}(0,1)\)</span>. What is the percent reduction in
variance of <span class="math inline">\(\hat{\theta}\)</span> that can
be achieved using antithetic variates (compared with simple MC)?</p>
<p><strong>Solution.</strong></p>
<p>Denote <span class="math inline">\(T_1=e^U, T_2=e^{1-U}\)</span>,
then <span class="math inline">\(\mathbb{E}T_1=\mathbb{E}T_2=\theta\)</span>. SO
the sample means for <span class="math inline">\(T_1\)</span> and <span class="math inline">\(T_2\)</span> are unbiased estimations for <span class="math inline">\(\theta\)</span>.</p>
<p><span class="math display">\[\begin{aligned}\operatorname{Cov}(T_1,T_2)&amp;=\int_0^1e^x\times
e^{1-x}dx-\left(\int_0^1 e^x dx\right)^2\\&amp;=3e-e^2-1.
\end{aligned}\]</span></p>
<p><span class="math display">\[\begin{aligned}\operatorname{Var}(T_1+T_2)&amp;=\operatorname{Var}(T_1)+\operatorname{Var}(T_2)+2\operatorname{Cov}(T_1,T_2)\\
&amp;=2\times\left(\frac{e^2-1}{2}-(e-1)^2\right)+2\times
\left(e-(e-1)^2\right)\\
&amp;=10e-3e^2-5
\end{aligned}\]</span></p>
<p>For <span class="math inline">\(m\)</span> replicates, the variance
of simple MC is <span class="math inline">\(\operatorname{Var}(T_1)/m\)</span>. The variance
of antithetic variate approach is <span class="math inline">\(\operatorname{Var}(T_1+T_2)/4m\)</span>.</p>
<p>The simple MC estimator is</p>
<p><span class="math display">\[\hat{\theta}=\frac 1m\sum_{i=1}^m
e^{U_i},\]</span> and the antithetic variate approach estimator is</p>
<p><span class="math display">\[\tilde{\theta}=\frac{1}{2m}\sum_{i=1}^m(e^{U_i}+e^{1-U_i}).\]</span></p>
<p>Theoretical percent reduction in variance using the antithetic
variate compared with the simple Monte Carlo estimate is <span class="math display">\[1-\frac{\operatorname{Var}(\tilde{\theta})}{\operatorname{Var}(\hat{\theta})}=1-\frac{10e-3e^2-5}{4(\frac{e^2-1}{2}-(e-1)^2)}=98.3835\%\]</span></p>
</div>
<div id="exercise-5.7" class="section level3">
<h3>Exercise 5.7</h3>
<p><strong>Problem.</strong> Refer to Exercise 5.6. Use a Monte Carlo
simulation to estimate <span class="math inline">\(\theta\)</span> by
the antithetic variate approach and by the simple Monte Carlo method.
Compute an empirical estimate of the percent reduction in variance using
the antithetic variate. Compare the result with the theoretical value
from Exercise 5.6.</p>
<p><strong>Solution.</strong> Using the estimator <span class="math inline">\(\hat{\theta}\)</span> and <span class="math inline">\(\tilde{\theta}\)</span> in Exercise 5.6, we use MC
method to compute empirically the percent reduction.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>T1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(U) <span class="co"># simple MC</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>T12 <span class="ot">&lt;-</span> (<span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>U)<span class="sc">+</span>T1)<span class="sc">/</span><span class="dv">2</span> <span class="co"># antithetic</span></span></code></pre></div>
<p>The result using simple MC is</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(T1)</span></code></pre></div>
<pre><code>## [1] 1.725018</code></pre>
<p>The result using antithetic variate method is</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(T12)</span></code></pre></div>
<pre><code>## [1] 1.718679</code></pre>
<p>The emperical percent variance reduction is</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">var</span>(T1)<span class="sc">-</span><span class="fu">var</span>(T12))<span class="sc">/</span><span class="fu">var</span>(T1)</span></code></pre></div>
<pre><code>## [1] 0.9839142</code></pre>
<p>It’s suggested that the theoretical percent reduction <span class="math inline">\(98.3835\%\)</span> is approximately achieved in
this simulation.</p>
</div>
</div>
<div id="hw3-0930" class="section level2">
<h2>HW3-0930</h2>
<div id="exercise-5.13" class="section level3">
<h3>Exercise 5.13</h3>
<p><strong>Problem.</strong></p>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to</p>
<p><span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},\quad
x&gt;1.\]</span></p>
<p>Which of your two importance functions should produce the smaller
variance in estimating</p>
<p><span class="math display">\[\int_1^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\]</span></p>
<p>by importance sampling? Explain.</p>
<p><strong>Solution.</strong></p>
<p>The candidates for the importance function are</p>
<p><span class="math display">\[
\begin{aligned}
f_1(x)&amp;=\frac{1}{\sqrt{2\pi}}e^{-x^2/2},\quad
-\infty&lt;x&lt;\infty,\\
f_2(x)&amp;=\frac{1}{2}x^2e^{-x},\quad 0&lt;x&lt;\infty,
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(f_1\)</span> is density function
for <span class="math inline">\(N(0,1)\)</span> and <span class="math inline">\(f_2\)</span> is density for <span class="math inline">\(\Gamma(3,1)\)</span>.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span><span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span><span class="dv">2</span></span></code></pre></div>
<p>We use importance sampling to calculate the integration.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> se<span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>fg<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span>m)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># using f1</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>fg[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f1</span>(x)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">1</span>] <span class="ot">&lt;-</span><span class="fu">mean</span>(fg[<span class="dv">1</span>,])</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg[<span class="dv">1</span>,])</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co"># using f2</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(m,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>fg[<span class="dv">2</span>,] <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f2</span>(x)</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>theta.hat[<span class="dv">2</span>] <span class="ot">&lt;-</span><span class="fu">mean</span>(fg[<span class="dv">2</span>,])</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>se[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg[<span class="dv">2</span>,])</span></code></pre></div>
<p>The estimates (labeled theta.hat) of <span class="math inline">\(\int_1^{\infty} g(x)dx\)</span> and the
corresponding standard errors se for the simulation using each of the
importance functions are:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(theta.hat,se)</span></code></pre></div>
<pre><code>##                [,1]      [,2]
## theta.hat 0.4021799 0.3956735
## se        1.1255863 0.4559163</code></pre>
<p>The simulation indicates that <span class="math inline">\(f_2\)</span> produce smaller variance than <span class="math inline">\(f_1\)</span>. Because <span class="math inline">\(f_1\)</span> is supported on the entire real line,
while <span class="math inline">\(g\)</span> is supported only on <span class="math inline">\((1,\infty)\)</span>. There are a vary large number
of zeros (more than 75%) produced in the ratio <span class="math inline">\(g(x)/f(x)\)</span>, and all other values far from
0, resulting in a large variance. But the ratio for <span class="math inline">\(f_2\)</span> is less than 25%. So <span class="math inline">\(f_2\)</span> performs better than <span class="math inline">\(f_1\)</span>. The following summary statistics for
the ratio <span class="math inline">\(g(x)/f_1(x)\)</span> and <span class="math inline">\(g(x)/f_2(x)\)</span> confirm this.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fg[<span class="dv">1</span>,])</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.0000  0.0000  0.0000  0.4022  0.0000 14.5766</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fg[<span class="dv">2</span>,])</span></code></pre></div>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
## 0.000000 0.002145 0.159973 0.395674 0.767270 1.315489</code></pre>
</div>
<div id="exercise-5.15" class="section level3">
<h3>Exercise 5.15</h3>
<p><strong>Problem.</strong> Obtain the stratified importance sampling
estimate in Example 5.13 and compare it with the result of Example
5.10.</p>
<p><strong>Solution.</strong></p>
<p>We need to estimate <span class="math inline">\(\theta =
\int_0^1\frac{e^{-x}}{1+x^2}dx\)</span>.</p>
<p>The best results in Example 5.13 is obtained by the importance
function <span class="math display">\[f_3(x)=e^{-x}/(1-e^{-1}),\quad
0&lt;x&lt;1,\]</span> corresponding codes are in below:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">*</span>(x<span class="sc">&lt;</span><span class="dv">1</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){ <span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">*</span>(x<span class="sc">&lt;</span><span class="dv">1</span>)}</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co"># f3, inverse transform method</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f</span>(x)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>theta.im <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>se.im <span class="ot">&lt;-</span><span class="fu">sd</span>(fg)</span></code></pre></div>
<p>In this way <span class="math inline">\(\hat{\theta}_1=\)</span>
0.5234 with <span class="math inline">\(se(\hat{\theta}_1)=\)</span>
0.0972.</p>
<p>Then we cut the interval as 5-folds: <span class="math inline">\(\left(F^{-1}((j-1)/5),F^{-1}(j/5)\right),j=1,\dots,5\)</span>.
On the <span class="math inline">\(j^{th}\)</span> subinterval variables
are generated from the density</p>
<p><span class="math display">\[\frac{5e^{-x}}{1-e^{-1}}\times1\left(F^{-1}((j-1)/5)&lt;x&lt;
F^{-1}(j/5)\right),\]</span></p>
<p>where <span class="math inline">\(F^{-1}(t)=-\log\left(1-(1-e^{-1})t\right)\)</span>.</p>
<p>Consider <span class="math inline">\(U_j\sim U[\frac
{j-1}{5},\frac{j}{5}],j=1,\dots,5\)</span> and <span class="math inline">\(\int_0^X\frac{e^{-t}}{1-e^{-1}}dt=U_j\)</span>.
Then we know X have the density <span class="math inline">\(\frac{5e^{-x}}{1-e^{-1}}\times1\left(F^{-1}((j-1)/5)&lt;x&lt;
F^{-1}(j/5)\right).\)</span></p>
<p>Now let we use transformation method to implement stratified
importance sampling.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span>m<span class="sc">/</span>k</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>theta_s <span class="ot">&lt;-</span> var_s <span class="ot">&lt;-</span><span class="fu">numeric</span>(k)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,(i<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">5</span>,i<span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>u)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span>k<span class="sc">/</span><span class="fu">f</span>(x)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  theta_s[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(fg)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  var_s[i]<span class="ot">&lt;-</span><span class="fu">var</span>(fg)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The <span class="math inline">\(\hat{\theta}\)</span> is</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(theta_s)</span></code></pre></div>
<pre><code>## [1] 0.5246954</code></pre>
<p>And <span class="math inline">\(se(\hat{\theta})\)</span> is</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">sum</span>(var_s))</span></code></pre></div>
<pre><code>## [1] 0.00938088</code></pre>
<p>which is less than one-tenth of simple importance sampling method
(<span class="math inline">\(se(\hat{\theta}_1)=\)</span> 0.0972).</p>
</div>
</div>
<div id="hw4-1009" class="section level2">
<h2>HW4-1009</h2>
<div id="exercise-6.4" class="section level3">
<h3>Exercise 6.4</h3>
<p><strong>Problem.</strong></p>
<p>Suppose that <span class="math inline">\(X_1, \dots , X_n\)</span>
are a random sample from a from a lognormal distribution with unknown
parameters. Construct a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain
an empirical estimate of the confidence level.</p>
<p><strong>Solution.</strong></p>
<p>Suppose <span class="math inline">\(\ln X_i\sim
N(\mu,\sigma^2)\)</span>, then <span class="math inline">\(\sqrt{n}(\overline{\ln X}-\mu)/\sigma\sim
N(0,1)\)</span>, <span class="math inline">\(S^2/\sigma^2\sim
\chi^2_{n-1}\)</span> and <span class="math inline">\(S^2\)</span> is
independent with <span class="math inline">\(\overline{\ln X}\)</span>,
where <span class="math display">\[S^2=\frac{1}{n-1}\sum(\ln
X_i-\overline{\ln X})^2.\]</span> So we know <span class="math inline">\(\sqrt{n}(\overline{\ln X}-\mu)/S\sim
t_{n-1}\)</span>. Then a 95% CI for <span class="math inline">\(\mu\)</span> is <span class="math display">\[\overline{\ln
X}\pm\frac{t_{n-1}(0.025)}{\sqrt{n(n-1)}}\sqrt{\sum_{i=1}^n(\ln
X_i-\overline{\ln X})^2}.\]</span></p>
<p>Now we use MC to calculate it. We generate <span class="math inline">\(X_1,\dots,X_n\)</span> from lognormal distribution
with <span class="math inline">\(\mu=0,\sigma=1\)</span>.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>gen_lognorm <span class="ot">&lt;-</span> <span class="cf">function</span>(n,mu,sigma){</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co"># n the number of samples</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,mu,sigma)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">exp</span>(y))</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="co"># generate data</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">gen_lognorm</span>(n,mu,sigma)</span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate CI</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>x_log <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">log</span>(x))</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sd</span>(<span class="fu">log</span>(x))</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> x_log<span class="sc">-</span><span class="fu">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n)<span class="sc">*</span>s</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>cu <span class="ot">&lt;-</span> x_log<span class="sc">+</span><span class="fu">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n)<span class="sc">*</span>s</span></code></pre></div>
<p>So the lower bound for 95% CI for <span class="math inline">\(\mu\)</span> is</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cl)</span></code></pre></div>
<pre><code>## [1] -0.02258659</code></pre>
<p>The upper bound for 95% CI for <span class="math inline">\(\mu\)</span> is</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cu)</span></code></pre></div>
<pre><code>## [1] 0.01702729</code></pre>
<p>We give a emperical 95% confidence interval [-0.023,0.017].</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clear up memory</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##           used (Mb) gc trigger (Mb) max used (Mb)
## Ncells  843701 45.1    1586422 84.8  1586422 84.8
## Vcells 1494331 11.5    8388608 64.0  8388606 64.0</code></pre>
</div>
<div id="exercise-6.8" class="section level3">
<h3>Exercise 6.8</h3>
<p><strong>Problem</strong> Refer to Example 6.16. Repeat the
simulation, but also compute the F test of equal variance, at
significance level <span class="math inline">\(\hat{\alpha}\)</span> =
0.055. Compare the power of the Count Five test and F test for small,
medium, and large sample sizes. (Recall that the F test is not
applicable for non-normal distributions.)</p>
<p><strong>Solution</strong> We use “count5test” to implement Count Five
test. We use “var.test” in R to do F test.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>count5test <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>x_center <span class="ot">&lt;-</span> x<span class="sc">-</span><span class="fu">mean</span>(x)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>y_center <span class="ot">&lt;-</span> y<span class="sc">-</span><span class="fu">mean</span>(y)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(x_center<span class="sc">&gt;</span><span class="fu">max</span>(y_center))<span class="sc">+</span><span class="fu">sum</span>(x_center<span class="sc">&lt;</span><span class="fu">min</span>(y_center))</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(y_center<span class="sc">&gt;</span><span class="fu">max</span>(x_center))<span class="sc">+</span><span class="fu">sum</span>(y_center<span class="sc">&lt;</span><span class="fu">min</span>(x_center))</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="co"># return 1 (reject) or 0 (not reject H_0)</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">as.integer</span>(<span class="fu">max</span>(outx,outy)<span class="sc">&gt;</span><span class="dv">5</span>))</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>First, we consider normal distribution. Consider <span class="math inline">\(N(0,1^2)\)</span> and <span class="math inline">\(N(0,1.5^2)\)</span>. Repeat 10000 times.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co"># generate the data and do test</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>simu_norm <span class="ot">&lt;-</span> <span class="cf">function</span>(i,n,mu,sigma1,sigma2){</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># i the seed</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co"># n the number of samples</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="co"># sigma1 standard error for X</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co"># sigma2 standard error for y</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(i)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,mu,sigma1)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,mu,sigma2)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="co"># the result of count5test and F test (with confidence level equals 0.055)</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">count5test</span>(x,y),  <span class="fu">as.integer</span>(<span class="fu">var.test</span>(x,y)<span class="sc">$</span>p.value<span class="sc">&lt;</span><span class="fl">0.055</span>))</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(test)</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We calculate powers for the two test in three cases: (1) small
samples, <span class="math inline">\(n_1=n_2=20\)</span>,(2) medium
samples, <span class="math inline">\(n_1=n_2=50\)</span>,(3) large
samples, <span class="math inline">\(n_1=n_2=100\)</span>.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>sigma1<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>sigma2<span class="ot">&lt;-</span><span class="fl">1.5</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co"># power for small samples</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>power_s <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>m,<span class="cf">function</span>(i) <span class="fu">simu_norm</span>(i,n,mu,sigma1,sigma2)))</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="co"># power for medium samples</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>power_m <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>m,<span class="cf">function</span>(i) <span class="fu">simu_norm</span>(i,n,mu,sigma1,sigma2)))</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="co"># power for large samples</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>power_l <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>m,<span class="cf">function</span>(i) <span class="fu">simu_norm</span>(i,n,mu,sigma1,sigma2)))</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>power_norm <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">20</span>,power_s,<span class="dv">50</span>,power_m,<span class="dv">100</span>,power_l),<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">byrow=</span>T)</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(power_norm)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;n&quot;</span>,<span class="st">&quot;count5test&quot;</span>,<span class="st">&quot;F-test&quot;</span>)</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(power_norm,<span class="at">caption =</span> <span class="st">&quot;Power for samples from norm distribution&quot;</span>)</span></code></pre></div>
<table>
<caption>
Power for samples from norm distribution
</caption>
<thead>
<tr>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
count5test
</th>
<th style="text-align:right;">
F-test
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
0.3203
</td>
<td style="text-align:right;">
0.4203
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.6598
</td>
<td style="text-align:right;">
0.8134
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.8509
</td>
<td style="text-align:right;">
0.9825
</td>
</tr>
</tbody>
</table>
<p>F test performs better than Count Five test. Because F test assume
that data is generated from normal distributions, which is consistent
with the setting in this simulation.</p>
<p>Then we consider Gamma distributions: <span class="math inline">\(\Gamma(1,1),\Gamma(0.5,0.5)\)</span>. They have
the same <span class="math inline">\(\mu=1\)</span> but different
variances: <span class="math inline">\(\sigma_1^2=1,\sigma^2_2=2\)</span>.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate the data and do test</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>simu_gamma <span class="ot">&lt;-</span> <span class="cf">function</span>(i,n,a1,b1,a2,b2){</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co"># i the seed</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># n the number of samples</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co"># a1,a2 shape parameters for X,y</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co"># b1,b2 rate parameters for x,y</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(i)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n,a1,b1)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n,a2,b2)</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="co"># the result of count5test and F test (with confidence level equals 0.055)</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">count5test</span>(x,y),  <span class="fu">as.integer</span>(<span class="fu">var.test</span>(x,y)<span class="sc">$</span>p.value<span class="sc">&lt;</span><span class="fl">0.055</span>))</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(test)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>a1 <span class="ot">&lt;-</span>b1<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>a2<span class="ot">&lt;-</span>b2<span class="ot">&lt;-</span><span class="fl">0.5</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># power for small samples</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>power_s <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>m,<span class="cf">function</span>(i) <span class="fu">simu_gamma</span>(i,n,a1,b1,a2,b2)))</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co"># power for medium samples</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>power_m <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>m,<span class="cf">function</span>(i) <span class="fu">simu_gamma</span>(i,n,a1,b1,a2,b2)))</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="co"># power for large samples</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>power_l <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>m,<span class="cf">function</span>(i) <span class="fu">simu_gamma</span>(i,n,a1,b1,a2,b2)))</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>power_gamma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">20</span>,power_s,<span class="dv">50</span>,power_m,<span class="dv">100</span>,power_l),<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">byrow=</span>T)</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(power_gamma)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;n&quot;</span>,<span class="st">&quot;count5test&quot;</span>,<span class="st">&quot;F-test&quot;</span>)</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(power_gamma,<span class="at">caption =</span> <span class="st">&quot;Power for samples from gamma distribution&quot;</span>)</span></code></pre></div>
<table>
<caption>
Power for samples from gamma distribution
</caption>
<thead>
<tr>
<th style="text-align:right;">
n
</th>
<th style="text-align:right;">
count5test
</th>
<th style="text-align:right;">
F-test
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
0.6329
</td>
<td style="text-align:right;">
0.4305
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
0.8197
</td>
<td style="text-align:right;">
0.5937
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0.8865
</td>
<td style="text-align:right;">
0.7477
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="hw5-1014" class="section level2">
<h2>HW5-1014</h2>
<div id="question1ans" class="section level3">
<h3>Exercise 7.4</h3>
<p><strong>Problem.</strong></p>
<p>Refer to the air-conditioning data set air-conditioning provided in
the boot package. The 12 observations are the times in hours between
failures of air-conditioning equipment [63, Example 1.1]: <span class="math display">\[3, 5, 7, 18, 43, 85, 91, 98,100, 130, 230,
487.\]</span> Assume that the times between failures follow an
exponential model <span class="math inline">\(Exp(\lambda)\)</span>.
Obtain the MLE of the hazard rate <span class="math inline">\(\lambda\)</span> and use bootstrap to estimate the
bias and standard error of the estimate.</p>
<p><strong>Solution.</strong></p>
<p>Suppose we have samples <span class="math inline">\(X_1,\dots,X_n,\text{i.i.d.}\sim
Exp(\lambda)\)</span> then their likelihood is <span class="math display">\[L(X_1,\dots,X_n)=\lambda^ne^{-\lambda\sum_{i=1}^nX_i}1(\lambda&gt;0).\]</span></p>
<p>Note that <span class="math inline">\(\frac{d\log
L}{d\lambda}=\frac{n}{\lambda}-\sum_{i=1}^nX_i\)</span>, which is
monotonic w.r.t. <span class="math inline">\(\lambda\)</span>. Let <span class="math inline">\(\frac{d\log L}{d\lambda}=0\)</span>,we know that
<span class="math display">\[\hat{\lambda}_{MLE}=\frac{n}{\sum_{i=1}^nX_i}.\]</span></p>
<p>We use the formule to obtain <span class="math inline">\(\hat{\lambda}_{MLE}.\)</span></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>time_fail <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>,<span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>lambda_mle <span class="ot">&lt;-</span><span class="fu">length</span>(time_fail)<span class="sc">/</span><span class="fu">sum</span>(time_fail)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The MLE of the hazard rate is &quot;</span>, <span class="fu">round</span>(lambda_mle,<span class="dv">5</span>),<span class="st">&quot;.&quot;</span>)</span></code></pre></div>
<pre><code>## The MLE of the hazard rate is  0.00925 .</code></pre>
<p>Ten we use bootstrap to estimate the bias and standard error of the
estimate.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fl">1e4</span> <span class="co"># times for bootstrap</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>lambda_b <span class="ot">&lt;-</span><span class="fu">numeric</span>(B)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">99</span>)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># bootstrap</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  lambda_b[i]<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(<span class="fu">sample</span>(time_fail,<span class="dv">12</span>,<span class="at">replace =</span> T))</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate bias and se</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>lambda_bias <span class="ot">&lt;-</span> <span class="fu">mean</span>(lambda_b)<span class="sc">-</span>lambda_mle</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>se.lambda <span class="ot">&lt;-</span> <span class="fu">sd</span>(lambda_b)</span></code></pre></div>
<p>The bias of the estimate is</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(lambda_bias,<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.0013</code></pre>
<p>The standard error of the estimate is</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(se.lambda,<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.00425</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clear up memory</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##           used (Mb) gc trigger (Mb) max used (Mb)
## Ncells  845557 45.2    1586422 84.8  1586422 84.8
## Vcells 1504438 11.5    8388608 64.0  8388606 64.0</code></pre>
</div>
<div id="exercise-7.5" class="section level3">
<h3>Exercise 7.5</h3>
<p><strong>Problem</strong> Refer to Exercise 7.4. Compute 95% bootstrap
confidence intervals for the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ.</p>
<p><strong>Solution</strong></p>
<p>We use the ‘boot’ and ‘boot.ci’ in R to calculate bootstrap
confidence intervals for <span class="math inline">\(1/\lambda\)</span>.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>time_fail <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>,<span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">76</span>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>stat.b <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>time_fail, <span class="at">statistic=</span><span class="cf">function</span>(x,i) <span class="fu">mean</span>(x[i]),<span class="at">R=</span>R)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate CI</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(stat.b, <span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>CIs <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(ci<span class="sc">$</span>normal[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>],ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>],ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>],ci<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]),<span class="at">nrow=</span><span class="dv">4</span>,<span class="at">byrow=</span>T)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(CIs)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;lower&quot;</span>,<span class="st">&quot;upper&quot;</span>)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(CIs) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;normal&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;percentile&quot;</span>,<span class="st">&quot;BCa&quot;</span>)</span></code></pre></div>
<p>Then 95% CIs obtained through these methods are</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(CIs,<span class="at">digits=</span><span class="dv">3</span>,<span class="at">caption =</span> <span class="st">&quot;95% CI&quot;</span>)</span></code></pre></div>
<table>
<caption>
95% CI
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
lower
</th>
<th style="text-align:right;">
upper
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
normal
</td>
<td style="text-align:right;">
36.038
</td>
<td style="text-align:right;">
181.328
</td>
</tr>
<tr>
<td style="text-align:left;">
basic
</td>
<td style="text-align:right;">
26.167
</td>
<td style="text-align:right;">
169.915
</td>
</tr>
<tr>
<td style="text-align:left;">
percentile
</td>
<td style="text-align:right;">
46.252
</td>
<td style="text-align:right;">
190.000
</td>
</tr>
<tr>
<td style="text-align:left;">
BCa
</td>
<td style="text-align:right;">
57.894
</td>
<td style="text-align:right;">
222.437
</td>
</tr>
</tbody>
</table>
<p>All these CIs cover $=$108.0833333.And both the lower bound and upper
bound of CIs satisfy <span class="math display">\[basic&lt;normal&lt;percentile&lt;BCa\]</span>.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare the length of for CIs</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">order</span>(CIs[,<span class="dv">2</span>]<span class="sc">-</span>CIs[,<span class="dv">1</span>],<span class="at">decreasing =</span> F)</span></code></pre></div>
<pre><code>## [1] 3 2 1 4</code></pre>
<p>And the length of four CIs satisfy <span class="math display">\[percentile&lt;basic&lt;normal&lt;BCa\]</span>
These CIs are different because they use different assumptions or
models.</p>
<p>Normal CI assumes that <span class="math inline">\(\hat{\theta}\)</span> is unbiased for <span class="math inline">\(\theta=1/\lambda\)</span> and the sample size is
large. However, this sample size is small (only 12) and <span class="math inline">\(\hat{\theta}\)</span> may not be unbiased since
the bias estimated by bootstrap is-0.6. So this CI may not be very
good.</p>
<p>The key idea of basic CI is to estimate quantile of the bias of <span class="math inline">\(\hat{\theta}:b_{\alpha/2},b_{1-\alpha/2}\)</span>.This
method is to make a model for bias to some degree.</p>
<p>The percentile CI use the fact that <span class="math inline">\(\hat{\theta}^*|X\)</span> have the same limit
distribution with <span class="math inline">\(\hat{\theta}\)</span>. So
the performance of this CI might not be so satisfactory when sample size
is small.</p>
<p>BCa CI is a modified version of percentile CI. We don’t need many
assumptions in this case.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clear up the memory</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##           used (Mb) gc trigger (Mb) max used (Mb)
## Ncells  862522 46.1    1586422 84.8  1586422 84.8
## Vcells 1540093 11.8    8388608 64.0  8388606 64.0</code></pre>
</div>
<div id="project-7.a" class="section level3">
<h3>Project 7.A</h3>
<p><strong>Problem</strong> Conduct a Monte Carlo study to estimate the
coverage probabilities of the standard normal bootstrap confidence
interval, the basic bootstrap confidence interval, and the percentile
confidence interval.</p>
<p>Sample from a normal population and check the empirical coverage
rates for the sample mean. Find the proportion of times that the
confidence intervals miss on the left, and the porportion of times that
the confidence intervals miss on the right.</p>
<p><strong>Solution</strong></p>
<p>We generate 50 samples from <span class="math inline">\(N(0,1)\)</span> each time and repeat 10000 times.
Each time we generate 199 groups of bootstrap sample and calculate 95%
confidence intervals use the three methods mentioned in the
question.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">199</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>ci.norm <span class="ot">&lt;-</span> ci.basic<span class="ot">&lt;-</span>ci.percent <span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>boot_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) <span class="fu">mean</span>(x[i])</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">50</span> <span class="co"># the number of samples to generate at each time</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="co"># use MC to calculate CI</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(i)</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,mu,<span class="dv">1</span>) <span class="co"># generate normal distribution with mean=mu and sd=1</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>  mean.b <span class="ot">&lt;-</span> <span class="fu">boot</span>(x,<span class="at">statistic=</span>boot_mean,<span class="at">R=</span>B)</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># obtain three 95% CIs</span></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>  CIs<span class="ot">&lt;-</span><span class="fu">boot.ci</span>(mean.b,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>  ci.norm[i,]<span class="ot">&lt;-</span>CIs<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>  ci.basic[i,] <span class="ot">&lt;-</span> CIs<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>  ci.percent[i,] <span class="ot">&lt;-</span> CIs<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>rate <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(rate) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;coverage&quot;</span>,<span class="st">&quot;miss on left&quot;</span>,<span class="st">&quot;miss on right&quot;</span>)</span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(rate)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;normal&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;percentile&quot;</span>)</span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a><span class="co"># the porportion of times that the confidence intervals miss on the left</span></span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a>rate[,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">sum</span>(mu<span class="sc">&lt;</span>ci.norm[,<span class="dv">1</span>]),<span class="fu">sum</span>(mu<span class="sc">&lt;</span>ci.basic[,<span class="dv">1</span>]),<span class="fu">sum</span>(mu<span class="sc">&lt;</span>ci.percent[,<span class="dv">1</span>]))<span class="sc">/</span>m</span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-28"><a href="#cb71-28" aria-hidden="true" tabindex="-1"></a><span class="co"># the porportion of times that the confidence intervals miss on the right</span></span>
<span id="cb71-29"><a href="#cb71-29" aria-hidden="true" tabindex="-1"></a>rate[,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">sum</span>(mu<span class="sc">&gt;</span>ci.norm[,<span class="dv">2</span>]),<span class="fu">sum</span>(mu<span class="sc">&gt;</span>ci.basic[,<span class="dv">2</span>]),<span class="fu">sum</span>(mu<span class="sc">&gt;</span>ci.percent[,<span class="dv">2</span>]))<span class="sc">/</span>m</span>
<span id="cb71-30"><a href="#cb71-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-31"><a href="#cb71-31" aria-hidden="true" tabindex="-1"></a><span class="co"># emperical coverage rates</span></span>
<span id="cb71-32"><a href="#cb71-32" aria-hidden="true" tabindex="-1"></a>rate[,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>rate[,<span class="dv">2</span>]<span class="sc">-</span>rate[,<span class="dv">3</span>]</span></code></pre></div>
<p>Empirical coverage rates and the proportion of times that the
confidence intervals miss on the left or right is shown in the table
below.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(rate,<span class="at">digits=</span><span class="dv">3</span>)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
coverage
</th>
<th style="text-align:right;">
miss on left
</th>
<th style="text-align:right;">
miss on right
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
normal
</td>
<td style="text-align:right;">
0.942
</td>
<td style="text-align:right;">
0.030
</td>
<td style="text-align:right;">
0.028
</td>
</tr>
<tr>
<td style="text-align:left;">
basic
</td>
<td style="text-align:right;">
0.942
</td>
<td style="text-align:right;">
0.029
</td>
<td style="text-align:right;">
0.029
</td>
</tr>
<tr>
<td style="text-align:left;">
percentile
</td>
<td style="text-align:right;">
0.944
</td>
<td style="text-align:right;">
0.029
</td>
<td style="text-align:right;">
0.027
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clear up the memory</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##           used (Mb) gc trigger (Mb) max used (Mb)
## Ncells  862778 46.1    1586422 84.8  1586422 84.8
## Vcells 1543778 11.8    8388608 64.0  8388606 64.0</code></pre>
</div>
</div>
<div id="hw6-1024" class="section level2">
<h2>HW6-1024</h2>
<div id="exercise-7.8" class="section level3">
<h3>Exercise 7.8</h3>
<p><strong>Problem.</strong></p>
<p>Consider data in package ‘bootstrap’. The five-dimensional scores
data have a <span class="math inline">\(5\times 5\)</span> covariance
matrix <span class="math inline">\(\Sigma\)</span> with positive
eigenvalues <span class="math inline">\(\lambda_1&gt;\cdots&gt;\lambda_5\)</span>. Let
<span class="math inline">\(\hat{\lambda}_1&gt;\cdots&gt;\hat{\lambda}_5\)</span>
be the eigenvalues of <span class="math inline">\(\hat{\Sigma}\)</span>,
where <span class="math inline">\(\hat{\Sigma}\)</span> is the MLE of
<span class="math inline">\(\Sigma\)</span>. <span class="math display">\[\hat{\theta}=\frac{\hat{\lambda}_1}{\sum_{j=1}^5\hat{\lambda}_j}\]</span>
<span class="math inline">\(\hat{\theta}\)</span> is the sample estimate
for <span class="math inline">\(\theta=\frac{\lambda_1}{\sum_{i=1}^5\lambda_i}\)</span>.
Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span></p>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="co"># load the data</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;scor&quot;</span>)</span></code></pre></div>
<p>The MLE of <span class="math inline">\(\Sigma\)</span> is <span class="math inline">\(\frac 1n (X_i-\bar{X})(X_i-\bar{X})^T, X_i\in
R^5\)</span> represents a student’s scores.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">88</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate theta</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>eigen_now <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(scor)<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n)<span class="sc">$</span>values</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> eigen_now[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(eigen_now)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="co"># use jackknife to obtain bias and se of theta.hat</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>theta.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  eigen_now <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(scor[<span class="sc">-</span>i,])<span class="sc">*</span>(n<span class="dv">-2</span>)<span class="sc">/</span>(n<span class="dv">-1</span>))<span class="sc">$</span>values</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>  theta.jack[i] <span class="ot">&lt;-</span> eigen_now[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(eigen_now)</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>bias.jack <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta.hat)</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>se.jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta.jack<span class="sc">-</span><span class="fu">mean</span>(theta.jack))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">c</span>(theta.hat,bias.jack,se.jack)</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(theta)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;original&quot;</span>,<span class="st">&quot;bias,jack&quot;</span>,<span class="st">&quot;se.jack&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># print results</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(theta,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  original bias,jack   se.jack 
##     0.619     0.001     0.050</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clear up memory</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##           used (Mb) gc trigger (Mb) max used (Mb)
## Ncells  870147 46.5    1586422 84.8  1586422 84.8
## Vcells 1560971 12.0    8388608 64.0  8388606 64.0</code></pre>
</div>
<div id="exercise-7.11" class="section level3">
<h3>Exercise 7.11</h3>
<p><strong>Problem</strong> In Example 7.18, leave-one-out (n-fold)
cross validation was used to select the best fitting model. Use
leave-two-out cross validation to compare the models.</p>
<p><strong>Solution</strong></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;ironslag&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> n<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span> <span class="co"># possible cases for leave-two-out</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(l)</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)){</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n){</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># leave- two-out</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>    inds <span class="ot">&lt;-</span> <span class="fu">c</span>(i,j)</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>inds]</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>inds]</span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># linear</span></span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>    m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x)</span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>    yhat1 <span class="ot">&lt;-</span> m1<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>m1<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[inds]</span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>    e1[ind] <span class="ot">&lt;-</span> <span class="fu">mean</span>((magnetic[inds]<span class="sc">-</span>yhat1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># quadratic</span></span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a>    m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span> x<span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a>    yhat2 <span class="ot">&lt;-</span> m2<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>m2<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[inds]<span class="sc">+</span>m2<span class="sc">$</span>coef[<span class="dv">3</span>]<span class="sc">*</span>chemical[inds]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a>    e2[ind]<span class="ot">&lt;-</span><span class="fu">mean</span>((magnetic[inds]<span class="sc">-</span>yhat2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb82-24"><a href="#cb82-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb82-25"><a href="#cb82-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># exponential</span></span>
<span id="cb82-26"><a href="#cb82-26" aria-hidden="true" tabindex="-1"></a>    m3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb82-27"><a href="#cb82-27" aria-hidden="true" tabindex="-1"></a>    logyhat3 <span class="ot">&lt;-</span> m3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> m3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[inds]</span>
<span id="cb82-28"><a href="#cb82-28" aria-hidden="true" tabindex="-1"></a>    yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb82-29"><a href="#cb82-29" aria-hidden="true" tabindex="-1"></a>    e3[ind] <span class="ot">&lt;-</span> <span class="fu">mean</span>((magnetic[inds] <span class="sc">-</span> yhat3)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb82-30"><a href="#cb82-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb82-31"><a href="#cb82-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># log-log</span></span>
<span id="cb82-32"><a href="#cb82-32" aria-hidden="true" tabindex="-1"></a>    m4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb82-33"><a href="#cb82-33" aria-hidden="true" tabindex="-1"></a>    logyhat4 <span class="ot">&lt;-</span> m4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> m4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[inds])</span>
<span id="cb82-34"><a href="#cb82-34" aria-hidden="true" tabindex="-1"></a>    yhat4 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4)</span>
<span id="cb82-35"><a href="#cb82-35" aria-hidden="true" tabindex="-1"></a>    e4[ind] <span class="ot">&lt;-</span> <span class="fu">mean</span>((magnetic[inds] <span class="sc">-</span> yhat4)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb82-36"><a href="#cb82-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb82-37"><a href="#cb82-37" aria-hidden="true" tabindex="-1"></a>    ind <span class="ot">=</span> ind<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb82-38"><a href="#cb82-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb82-39"><a href="#cb82-39" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The MSE obtained by CV is as below:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(e1),<span class="fu">mean</span>(e2),<span class="fu">mean</span>(e3),<span class="fu">mean</span>(e4))</span></code></pre></div>
<pre><code>## [1] 19.57227 17.87018 18.45491 20.46718</code></pre>
<p>It’s obvious that quadratic model is the best fitting model.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clear up the memory</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##           used (Mb) gc trigger (Mb) max used (Mb)
## Ncells  918131 49.1    1586422 84.8  1586422 84.8
## Vcells 1626325 12.5    8388608 64.0  8388606 64.0</code></pre>
</div>
<div id="exercise-8.2" class="section level3">
<h3>Exercise 8.2</h3>
<p><strong>Problem</strong> Implement the bivariate Spearman rank
correlation test for independence [255] as a permutation test. The
Spearman rank correlation test statistic can be obtained from function
cor with method = “spearman”. Compare the achieved significance level of
the permutation test with the p-value reported by cor.test on the same
samples.</p>
<p><strong>Solution</strong> We generate <span class="math inline">\(X\sim N(0,1)\)</span> and <span class="math inline">\(Y=X^3\)</span>. We test the independence for <span class="math inline">\(X,Y\)</span>. Generate <span class="math inline">\(n=100\)</span> samples.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate data</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">129</span>)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">3</span></span></code></pre></div>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(StatComp22003)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;StatComp22003&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     ordered</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(x,y),<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>spearman <span class="ot">&lt;-</span> <span class="cf">function</span>(z,ix){</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> z[,<span class="dv">1</span>] <span class="co"># leave x as it is</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> z[ix,<span class="dv">2</span>] <span class="co">#permute rows of y</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">cor</span>(x,y,<span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>))</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="co"># permutation</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>permu <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>z,<span class="at">statistic =</span> spearman,<span class="at">R=</span><span class="dv">999</span>,<span class="at">sim=</span><span class="st">&quot;permutation&quot;</span>)</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>tb <span class="ot">&lt;-</span> <span class="fu">c</span>(permu<span class="sc">$</span>t0,permu<span class="sc">$</span>t)</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a><span class="co"># p-value for permutation test</span></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(tb)<span class="sc">&gt;=</span><span class="fu">abs</span>(tb[<span class="dv">1</span>]))</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>## [1] 0.001</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(x,y)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  x and y
## t = 12.805, df = 98, p-value &lt; 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.7041563 0.8547449
## sample estimates:
##       cor 
## 0.7911511</code></pre>
<p>The p-value reported by is less than 2.2e-16 which is much less than
p-value reported by permutation test which is 0.001.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clear up the memory</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##           used (Mb) gc trigger (Mb) max used (Mb)
## Ncells  925886 49.5    1586422 84.8  1586422 84.8
## Vcells 1644868 12.6    8388608 64.0  8388606 64.0</code></pre>
</div>
</div>
<div id="hw7-1028" class="section level2">
<h2>HW7-1028</h2>
<div id="exercise-9.4" class="section level3">
<h3>Exercise 9.4</h3>
<p><strong>Problem.</strong></p>
<p>Implement a random walk Metropolis sampler for generating the
standard Laplace distribution (see Exercise 3.2). For the increment,
simulate from a normal distribution. Compare the chains generated when
different variances are used for the proposal distribution. Also,
compute the acceptance rates of each chain.</p>
<p><strong>Solution.</strong></p>
<p>We use <span class="math inline">\(N(X_t,\sigma^2)\)</span> as
proposal distribution to generate the standard Laplace distribution, the
acceptance probability is</p>
<p><span class="math display">\[\alpha(X_{i},Y)=\min
(e^{|X_i|-|Y|},1).\]</span></p>
<p>We consider <span class="math inline">\(\sigma=0.5,1,2,4\)</span>.
For each <span class="math inline">\(\sigma\)</span>, we generate <span class="math inline">\(k=5\)</span> chains with length <span class="math inline">\(N=5000\)</span> and initial value <span class="math inline">\(-10,-5,0,5,10\)</span>. We take <span class="math inline">\(\psi(X_1,\dots,X_n)=\frac 1n \sum_{i=1}^n
X_i\)</span> to monitor the convergence of chains.</p>
<div id="functions-used" class="section level4">
<h4>Functions used</h4>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate a chain</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>rw.laplace <span class="ot">&lt;-</span> <span class="cf">function</span>(x0, N, sigma){</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># x0 initiial value</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># N the length of the chain</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sigma sd for proposal distribution</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># count acceptance cases</span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> <span class="fu">exp</span>(<span class="fu">abs</span>(x[i<span class="dv">-1</span>])<span class="sc">-</span><span class="fu">abs</span>(y))){</span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span> {</span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a>    } </span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x, <span class="at">k=</span>k))</span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-23"><a href="#cb97-23" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate $\hat{R}$ to monitor convergence </span></span>
<span id="cb97-24"><a href="#cb97-24" aria-hidden="true" tabindex="-1"></a>cal.GR <span class="ot">&lt;-</span> <span class="cf">function</span>(psi){</span>
<span id="cb97-25"><a href="#cb97-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># psi[i,j] is the diagnostic statistic psi(X[i,1:j])</span></span>
<span id="cb97-26"><a href="#cb97-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># for chain in i-th row of X</span></span>
<span id="cb97-27"><a href="#cb97-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb97-28"><a href="#cb97-28" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi) </span>
<span id="cb97-29"><a href="#cb97-29" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb97-30"><a href="#cb97-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb97-31"><a href="#cb97-31" aria-hidden="true" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)</span>
<span id="cb97-32"><a href="#cb97-32" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n<span class="sc">*</span><span class="fu">var</span>(psi.means)  <span class="co"># between variance est.</span></span>
<span id="cb97-33"><a href="#cb97-33" aria-hidden="true" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, var)</span>
<span id="cb97-34"><a href="#cb97-34" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)        <span class="co"># within variance est.</span></span>
<span id="cb97-35"><a href="#cb97-35" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n<span class="sc">+</span>B<span class="sc">/</span>n  <span class="co"># var(psi) est.</span></span>
<span id="cb97-36"><a href="#cb97-36" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(v.hat<span class="sc">/</span>W)  <span class="co"># G-R statistic</span></span>
<span id="cb97-37"><a href="#cb97-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb97-38"><a href="#cb97-38" aria-hidden="true" tabindex="-1"></a> }</span></code></pre></div>
</div>
<div id="generate-chains" class="section level4">
<h4>Generate chains</h4>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">10</span>)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>sigmas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co"># length of chains </span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">500</span> <span class="co"># burn-in lenght</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;s1&quot;</span><span class="ot">=</span><span class="fu">matrix</span>(<span class="at">nrow=</span>k,<span class="at">ncol=</span>N),<span class="st">&quot;s2&quot;</span><span class="ot">=</span><span class="fu">matrix</span>(<span class="at">nrow=</span>k,<span class="at">ncol=</span>N),<span class="st">&quot;s3&quot;</span><span class="ot">=</span><span class="fu">matrix</span>(<span class="at">nrow=</span>k,<span class="at">ncol=</span>N),<span class="st">&quot;s4&quot;</span><span class="ot">=</span><span class="fu">matrix</span>(<span class="at">nrow=</span>k,<span class="at">ncol=</span>N)) <span class="co"># collect chains</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>accept <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span><span class="fu">length</span>(sigmas), <span class="at">ncol=</span>k) <span class="co"># record acceptance rate for each chain</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">225</span>)</span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>  mc <span class="ot">&lt;-</span> <span class="fu">rw.laplace</span>(x0[i],N,sigmas[<span class="dv">1</span>])</span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>  X<span class="sc">$</span>s1[i,] <span class="ot">&lt;-</span> mc<span class="sc">$</span>x</span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>  accept[<span class="dv">1</span>,i] <span class="ot">&lt;-</span> mc<span class="sc">$</span>k<span class="sc">/</span>N</span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>  mc <span class="ot">&lt;-</span> <span class="fu">rw.laplace</span>(x0[i],N,sigmas[<span class="dv">2</span>])</span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>  X<span class="sc">$</span>s2[i,] <span class="ot">&lt;-</span> mc<span class="sc">$</span>x</span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>  accept[<span class="dv">2</span>,i] <span class="ot">&lt;-</span> mc<span class="sc">$</span>k<span class="sc">/</span>N</span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a>  mc <span class="ot">&lt;-</span> <span class="fu">rw.laplace</span>(x0[i],N,sigmas[<span class="dv">3</span>])</span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a>  X<span class="sc">$</span>s3[i,] <span class="ot">&lt;-</span> mc<span class="sc">$</span>x</span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a>  accept[<span class="dv">3</span>,i] <span class="ot">&lt;-</span> mc<span class="sc">$</span>k<span class="sc">/</span>N</span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb98-25"><a href="#cb98-25" aria-hidden="true" tabindex="-1"></a>  mc <span class="ot">&lt;-</span> <span class="fu">rw.laplace</span>(x0[i],N,sigmas[<span class="dv">4</span>])</span>
<span id="cb98-26"><a href="#cb98-26" aria-hidden="true" tabindex="-1"></a>  X<span class="sc">$</span>s4[i,] <span class="ot">&lt;-</span> mc<span class="sc">$</span>x</span>
<span id="cb98-27"><a href="#cb98-27" aria-hidden="true" tabindex="-1"></a>  accept[<span class="dv">4</span>,i] <span class="ot">&lt;-</span> mc<span class="sc">$</span>k<span class="sc">/</span>N</span>
<span id="cb98-28"><a href="#cb98-28" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="monitor-convergence" class="section level4">
<h4>Monitor convergence</h4>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;s1&quot;</span><span class="ot">=</span><span class="fu">matrix</span>(<span class="at">nrow=</span>k,<span class="at">ncol=</span>N),<span class="st">&quot;s2&quot;</span><span class="ot">=</span><span class="fu">matrix</span>(<span class="at">nrow=</span>k,<span class="at">ncol=</span>N),<span class="st">&quot;s3&quot;</span><span class="ot">=</span><span class="fu">matrix</span>(<span class="at">nrow=</span>k,<span class="at">ncol=</span>N),<span class="st">&quot;s4&quot;</span><span class="ot">=</span><span class="fu">matrix</span>(<span class="at">nrow=</span>k,<span class="at">ncol=</span>N))</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>R.hat <span class="ot">&lt;-</span><span class="fu">list</span>(<span class="st">&quot;s1&quot;</span><span class="ot">=</span><span class="fu">numeric</span>(N),<span class="st">&quot;s2&quot;</span><span class="ot">=</span><span class="fu">numeric</span>(N),<span class="st">&quot;s3&quot;</span><span class="ot">=</span><span class="fu">numeric</span>(N),<span class="st">&quot;s4&quot;</span><span class="ot">=</span><span class="fu">numeric</span>(N))</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>psi<span class="sc">$</span>s1 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X<span class="sc">$</span>s1,<span class="dv">1</span>,cumsum))</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>psi<span class="sc">$</span>s2 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X<span class="sc">$</span>s2,<span class="dv">1</span>,cumsum))</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>psi<span class="sc">$</span>s3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X<span class="sc">$</span>s3,<span class="dv">1</span>,cumsum))</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>psi<span class="sc">$</span>s4 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X<span class="sc">$</span>s4,<span class="dv">1</span>,cumsum))</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span> k){</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate the statistic psi</span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>  psi<span class="sc">$</span>s1[i,] <span class="ot">&lt;-</span> psi<span class="sc">$</span>s1[i,]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>  psi<span class="sc">$</span>s2[i,] <span class="ot">&lt;-</span> psi<span class="sc">$</span>s2[i,]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>  psi<span class="sc">$</span>s3[i,] <span class="ot">&lt;-</span> psi<span class="sc">$</span>s3[i,]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>  psi<span class="sc">$</span>s4[i,] <span class="ot">&lt;-</span> psi<span class="sc">$</span>s4[i,]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N){</span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>    R.hat<span class="sc">$</span>s1[j] <span class="ot">&lt;-</span> <span class="fu">cal.GR</span>(psi<span class="sc">$</span>s1[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>    R.hat<span class="sc">$</span>s2[j] <span class="ot">&lt;-</span> <span class="fu">cal.GR</span>(psi<span class="sc">$</span>s2[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>    R.hat<span class="sc">$</span>s3[j] <span class="ot">&lt;-</span> <span class="fu">cal.GR</span>(psi<span class="sc">$</span>s3[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a>    R.hat<span class="sc">$</span>s4[j] <span class="ot">&lt;-</span> <span class="fu">cal.GR</span>(psi<span class="sc">$</span>s4[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="show-results" class="section level4">
<h4>Show results</h4>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>accept <span class="ot">&lt;-</span> <span class="fu">cbind</span>(sigmas,accept)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(accept) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;sigma&quot;</span>,<span class="st">&quot;x0=-10&quot;</span>,<span class="st">&quot;x0=-5&quot;</span>,<span class="st">&quot;x0=0&quot;</span>,<span class="st">&quot;x0=5&quot;</span>,<span class="st">&quot;x0=10&quot;</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">round</span>(accept,<span class="dv">3</span>),<span class="at">caption=</span><span class="st">&quot;Acceptance rates&quot;</span>)</span></code></pre></div>
<table>
<caption>
Acceptance rates
</caption>
<thead>
<tr>
<th style="text-align:right;">
sigma
</th>
<th style="text-align:right;">
x0=-10
</th>
<th style="text-align:right;">
x0=-5
</th>
<th style="text-align:right;">
x0=0
</th>
<th style="text-align:right;">
x0=5
</th>
<th style="text-align:right;">
x0=10
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0.827
</td>
<td style="text-align:right;">
0.818
</td>
<td style="text-align:right;">
0.826
</td>
<td style="text-align:right;">
0.832
</td>
<td style="text-align:right;">
0.832
</td>
</tr>
<tr>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
0.688
</td>
<td style="text-align:right;">
0.689
</td>
<td style="text-align:right;">
0.686
</td>
<td style="text-align:right;">
0.703
</td>
<td style="text-align:right;">
0.699
</td>
</tr>
<tr>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:right;">
0.535
</td>
<td style="text-align:right;">
0.516
</td>
<td style="text-align:right;">
0.524
</td>
<td style="text-align:right;">
0.519
</td>
<td style="text-align:right;">
0.510
</td>
</tr>
<tr>
<td style="text-align:right;">
4.0
</td>
<td style="text-align:right;">
0.340
</td>
<td style="text-align:right;">
0.335
</td>
<td style="text-align:right;">
0.335
</td>
<td style="text-align:right;">
0.334
</td>
<td style="text-align:right;">
0.345
</td>
</tr>
</tbody>
</table>
<p>From the table, it’s obvious that the acceptance rate is decreasing
as <span class="math inline">\(\sigma\)</span> increases. And the
initial value <span class="math inline">\(x_0\)</span> seems to have no
significant impact on acceptance rate under the same <span class="math inline">\(\sigma\)</span>.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(R.hat<span class="sc">$</span>s1[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;R&quot;</span>,<span class="at">main=</span><span class="st">&quot;sigma=0.5&quot;</span>)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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ikSt7xpUUpGo9V2DSioStb5rUElFotZ3DSqpSNT6rkElFYla3zWopCJR67sGlVQkav29h4IAFASgIAAFASgIQEEACgJQEICCABQEoCAABQHCCyqy3sead1Iusvp58U2E9sYg7GOffaPUBBekn45fOBgqF6pSrp933kRobww7gkwL8o2yJrQgO5fa4bnC9m0C+dFtE6G9MYjnCy3IN0pDaEHNebpVV//CTYT2xqAQ+ckXJcg3SkNwQb/oHO56qwRkqU5kHaG9MfAAdB/kGeWF0IJsI3fphExt1Us3EdobAyLohmReEOIV5RWiBBXrPtr91PQLP0QL8mli9m0UXo3DFBXdxDw66dxeBXl1r3k9ueVSbCftPMy/WijjO0AvJQ/zzheKj/P12168L/GWki8UTZa7dNF149BVmwjtjUHYWw3fKDW8WQVQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAjwP+f2/0rpUNwRAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(R.hat<span class="sc">$</span>s2[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;R&quot;</span>,<span class="at">main=</span><span class="st">&quot;sigma=1&quot;</span>)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(R.hat<span class="sc">$</span>s3[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;R&quot;</span>,<span class="at">main=</span><span class="st">&quot;sigma=2&quot;</span>)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(R.hat<span class="sc">$</span>s4[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N],<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;R&quot;</span>,<span class="at">main=</span><span class="st">&quot;sigma=4&quot;</span>)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the pictures, we find that all the chains achieve convergence.
It seems that the convergence is achieved faster with a bigger <span class="math inline">\(\sigma\)</span>.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clean up the memory</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##           used (Mb) gc trigger (Mb) max used (Mb)
## Ncells  927463 49.6    1586422 84.8  1586422 84.8
## Vcells 1651225 12.6    8417606 64.3  8417606 64.3</code></pre>
</div>
</div>
<div id="exercise-9.7" class="section level3">
<h3>Exercise 9.7</h3>
<p><strong>Problem</strong></p>
<p>Implement a Gibbs sampler to generate a bivariate normal chain <span class="math inline">\((X_t, Y_t)\)</span> with zero means, unit standard
deviations, and correlation 0.9. Plot the generated sample after
discarding a suitable burn-in sample. Fit a simple linear regression
model <span class="math inline">\(Y = \beta_0 + \beta_1X\)</span> to the
sample and check the residuals of the model for normality and constant
variance.</p>
<p><strong>Solution</strong></p>
<p>The target distribution is bivariate normal <span class="math inline">\((X,Y)\sim N(0,\Sigma),
\Sigma_{11}=\Sigma_{22}=1,\Sigma_{12}=\Sigma_{21}=0.9\)</span>. The
condition distributions are</p>
<p><span class="math display">\[
\begin{aligned}
X_1|X_2&amp;\sim N(0.9x_2,0.19),\\
X_2|X_1&amp;\sim N(0.9x_1,0.19).
\end{aligned}
\]</span></p>
<p>We take <span class="math inline">\(\psi(X_1,\dots,X_n;Y_1,\dots,Y_n)=\frac 1 n \sum_i
X_iY_i-\bar{X}\bar{Y}\)</span> to monitor the convergence of chains.</p>
<div id="functions-used-1" class="section level4">
<h4>Functions used</h4>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span>k, <span class="at">ncol=</span>N)</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span>k, <span class="at">ncol=</span>N)</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fl">0.19</span>)</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>Gibbs.gen <span class="ot">&lt;-</span> <span class="cf">function</span>(x0,y0,N){</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>  y[<span class="dv">1</span>] <span class="ot">&lt;-</span> y0</span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># count acceptance cases</span></span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, rho<span class="sc">*</span>y[i<span class="dv">-1</span>], sd)</span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>    y[i] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,rho<span class="sc">*</span>x[i],sd)</span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">cbind</span>(x,y))</span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate $\hat{R}$ to monitor convergence </span></span>
<span id="cb107-24"><a href="#cb107-24" aria-hidden="true" tabindex="-1"></a>cal.GR <span class="ot">&lt;-</span> <span class="cf">function</span>(psi){</span>
<span id="cb107-25"><a href="#cb107-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># psi[i,j] is the diagnostic statistic psi(X[i,1:j])</span></span>
<span id="cb107-26"><a href="#cb107-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># for chain in i-th row of X</span></span>
<span id="cb107-27"><a href="#cb107-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-28"><a href="#cb107-28" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi) </span>
<span id="cb107-29"><a href="#cb107-29" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb107-30"><a href="#cb107-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-31"><a href="#cb107-31" aria-hidden="true" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)</span>
<span id="cb107-32"><a href="#cb107-32" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n<span class="sc">*</span><span class="fu">var</span>(psi.means)  <span class="co"># between variance est.</span></span>
<span id="cb107-33"><a href="#cb107-33" aria-hidden="true" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, var)</span>
<span id="cb107-34"><a href="#cb107-34" aria-hidden="true" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)        <span class="co"># within variance est.</span></span>
<span id="cb107-35"><a href="#cb107-35" aria-hidden="true" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n<span class="sc">+</span>B<span class="sc">/</span>n  <span class="co"># var(psi) est.</span></span>
<span id="cb107-36"><a href="#cb107-36" aria-hidden="true" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(v.hat<span class="sc">/</span>W)  <span class="co"># G-R statistic</span></span>
<span id="cb107-37"><a href="#cb107-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb107-38"><a href="#cb107-38" aria-hidden="true" tabindex="-1"></a> }</span></code></pre></div>
</div>
<div id="generate-chains-and-monitor-convergence" class="section level4">
<h4>Generate chains and monitor convergence</h4>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span><span class="sc">:</span><span class="dv">1</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>y0 <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:-</span><span class="dv">1</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="co"># take x0,y0 as initial value, we generate k chains with length N</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span><span class="dv">1000</span> <span class="co"># burn-in length</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>k,<span class="at">ncol=</span>N)</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">17</span>)</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a><span class="co"># generate chains</span></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>  xy <span class="ot">&lt;-</span> <span class="fu">Gibbs.gen</span>(x0[i],y0[i],N)</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>  X[i,] <span class="ot">&lt;-</span> xy[,<span class="dv">1</span>]</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>  Y[i,] <span class="ot">&lt;-</span> xy[,<span class="dv">2</span>]</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate psi</span></span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>N, <span class="cf">function</span>(j) <span class="fu">mean</span>(X[i,<span class="dv">1</span><span class="sc">:</span>j]<span class="sc">*</span>Y[i,<span class="dv">1</span><span class="sc">:</span>j])<span class="sc">-</span><span class="fu">mean</span>(X[i,<span class="dv">1</span><span class="sc">:</span>j])<span class="sc">*</span><span class="fu">mean</span>(Y[i,<span class="dv">1</span><span class="sc">:</span>j]))</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a>R.hat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N){</span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a>  R.hat[k] <span class="ot">&lt;-</span> <span class="fu">cal.GR</span>(psi[,<span class="dv">1</span><span class="sc">:</span>k])</span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="linear-regression-and-show-results" class="section level4">
<h4>Linear regression and show results</h4>
<p>We take the chain with initial value (-2,2) as an example to plot
generated sample and fit the linear regression model.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>X[<span class="dv">1</span>,<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)],<span class="at">y=</span>Y[<span class="dv">1</span>,<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)],<span class="at">xlab=</span><span class="st">&quot;X&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Y&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># linear regression</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>X[<span class="dv">1</span>,<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)]</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span>Y[<span class="dv">1</span>,<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)]</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>lmfit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x)</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(lmfit<span class="sc">$</span>residuals)</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(lmfit<span class="sc">$</span>residuals,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From Q-Q plot, we find that the residuals of the model are normality.
And the variance of residual is</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(lmfit<span class="sc">$</span>residuals)</span></code></pre></div>
<pre><code>## [1] 0.1913045</code></pre>
<p>It’s very close to the therotical variance <span class="math inline">\(0.19\)</span>.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(R.hat[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)],<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;R&quot;</span>,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The chains achieve convergence after 1000 burn-in times.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clear up the memory</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##           used (Mb) gc trigger (Mb) max used (Mb)
## Ncells  928773 49.7    1586422 84.8  1586422 84.8
## Vcells 1656287 12.7    8430941 64.4  8430941 64.4</code></pre>
</div>
</div>
</div>
<div id="hw8-1104" class="section level2">
<h2>HW8-1104</h2>
<div id="exercise-1" class="section level3">
<h3>Exercise 1</h3>
<p><strong>Solution.</strong></p>
<p>We consider <span class="math inline">\(X\sim N(5,1)\)</span>, <span class="math inline">\(M=a_M+\alpha X+e_M\)</span>,<span class="math inline">\(Y=a_Y+\beta M+\gamma X + e_Y\)</span>,<span class="math inline">\(e_M,e_Y \stackrel{i.i.d.}{\sim}N(0,1)\)</span>. We
take <span class="math inline">\(a_M=a_Y=1\)</span>, consider three
kinds scenarios:</p>
<table>
<thead>
<tr class="header">
<th align="left">Scenario</th>
<th align="left"><span class="math inline">\(\alpha\)</span></th>
<th align="left"><span class="math inline">\(\beta\)</span></th>
<th align="left"><span class="math inline">\(\gamma\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">1</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="left">1</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># function to generate data</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>gen_xmy <span class="ot">&lt;-</span> <span class="cf">function</span>(n,alpha,beta,<span class="at">gamma=</span><span class="dv">1</span>){</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># n number of samples</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>  em <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>  am <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>  ay <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> am <span class="sc">+</span>alpha<span class="sc">*</span>x<span class="sc">+</span>em</span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> ay <span class="sc">+</span> beta<span class="sc">*</span>m <span class="sc">+</span> gamma<span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="st">&quot;X&quot;</span><span class="ot">=</span>x,<span class="st">&quot;M&quot;</span><span class="ot">=</span>m,<span class="st">&quot;Y&quot;</span><span class="ot">=</span>y))</span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate alpha_hat and beta_hat</span></span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a>cal_a <span class="ot">&lt;-</span> <span class="cf">function</span>(X,M){</span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X,M)</span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># data is generated by gen_xmy with three components: X,M,Y</span></span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">lm</span>(M<span class="sc">~</span>X,<span class="at">data=</span>data)<span class="sc">$</span>coefficients[<span class="st">&quot;X&quot;</span>] <span class="co"># alpha_hat</span></span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(a)</span>
<span id="cb116-23"><a href="#cb116-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb116-24"><a href="#cb116-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-25"><a href="#cb116-25" aria-hidden="true" tabindex="-1"></a>cal_b <span class="ot">&lt;-</span> <span class="cf">function</span>(X,M,Y){</span>
<span id="cb116-26"><a href="#cb116-26" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X,M,Y)</span>
<span id="cb116-27"><a href="#cb116-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># data is generated by gen_xmy with three components: X,M,Y</span></span>
<span id="cb116-28"><a href="#cb116-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb116-29"><a href="#cb116-29" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y<span class="sc">~</span>X<span class="sc">+</span>M,<span class="at">data=</span>data)<span class="sc">$</span>coefficients[<span class="st">&quot;M&quot;</span>] <span class="co">#beta_hat</span></span>
<span id="cb116-30"><a href="#cb116-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(b)</span>
<span id="cb116-31"><a href="#cb116-31" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We take the confidence level <span class="math inline">\(\alpha_c=0.05\)</span> and calculate type 1 error
rates. Consider the number of samples <span class="math inline">\(n=20,50,100,200.\)</span> For each permutation
test we replicate <span class="math inline">\(R=199\)</span> times.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">200</span>)</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>R<span class="ot">&lt;-</span><span class="dv">199</span></span></code></pre></div>
<p>Note that we can’t take <span class="math inline">\(T=\frac{\hat{\alpha}\hat{\beta}}{\hat{se}(\hat{\alpha}\hat{\beta})}\)</span>
as test statistic. Because in one test we only have one <span class="math inline">\(\hat{\alpha}\)</span> and one <span class="math inline">\(\hat{\beta}\)</span>, we can’t calculate <span class="math inline">\(\hat{se}(\hat{\alpha}\hat{\beta}))\)</span>. We
will take <span class="math inline">\(T&#39;=|\hat{\alpha}\hat{\beta}|\)</span> as our
statistic for hypothesis test.We permute <span class="math inline">\(M\)</span> and calculate <span class="math inline">\(\hat{\alpha},\hat{\beta}\)</span> with unpermuted
X,Y.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We use perm to do permutation test </span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>perm <span class="ot">&lt;-</span> <span class="cf">function</span>(x,m,y,<span class="at">R=</span><span class="dv">199</span>){</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  ns <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>  inds <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>R,<span class="cf">function</span>(i) <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>ns,ns))) <span class="co"># permute indices</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>  t0 <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">cal_a</span>(x,m)<span class="sc">*</span><span class="fu">cal_b</span>(x,m,y))</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>  tp <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>R,<span class="cf">function</span>(i) <span class="fu">abs</span>(<span class="fu">cal_a</span>(x[inds[i,]],m)<span class="sc">*</span><span class="fu">cal_b</span>(x,m[inds[i,]],y))) <span class="co"># calculate T&#39; for permutated data</span></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>  ts <span class="ot">&lt;-</span> <span class="fu">c</span>(t0,tp)</span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>  p.value <span class="ot">&lt;-</span> <span class="fu">mean</span>(ts<span class="sc">&gt;</span>t0)</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="st">&quot;pvalue&quot;</span><span class="ot">=</span>p.value,<span class="st">&quot;t0&quot;</span><span class="ot">=</span>t0,<span class="st">&quot;tp&quot;</span><span class="ot">=</span>tp))</span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a><span class="co"># simulation fcn </span></span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>simu <span class="ot">&lt;-</span> <span class="cf">function</span>(i,n,alpha,beta,<span class="at">R=</span><span class="dv">199</span>){</span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(i)</span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">gen_xmy</span>(n,alpha,beta,<span class="dv">1</span>)</span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">perm</span>(data<span class="sc">$</span>X,data<span class="sc">$</span>M,data<span class="sc">$</span>Y,<span class="at">R=</span>R)<span class="sc">$</span>pvalue</span>
<span id="cb118-19"><a href="#cb118-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb118-20"><a href="#cb118-20" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Then we do simulation for <span class="math inline">\(n=20,50,100,200\)</span> under three scenarios. We
repeate 100 times for each case.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>test_result1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span><span class="fu">length</span>(n),<span class="at">ncol=</span><span class="dv">100</span>)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>test_result2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span><span class="fu">length</span>(n),<span class="at">ncol=</span><span class="dv">100</span>)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>test_result3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span><span class="fu">length</span>(n),<span class="at">ncol=</span><span class="dv">100</span>)</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)){</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>  test_result1[k,] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,<span class="cf">function</span>(i) <span class="fu">simu</span>(i,n[k],<span class="dv">0</span>,<span class="dv">0</span>))<span class="sc">&lt;</span><span class="fl">0.05</span></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>  test_result2[k,] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,<span class="cf">function</span>(i) <span class="fu">simu</span>(i,n[k],<span class="dv">0</span>,<span class="dv">1</span>))<span class="sc">&lt;</span><span class="fl">0.05</span></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>  test_result3[k,] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,<span class="cf">function</span>(i) <span class="fu">simu</span>(i,n[k],<span class="dv">1</span>,<span class="dv">0</span>))<span class="sc">&lt;</span><span class="fl">0.05</span></span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now let we see type one error in three scenarios.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">ncol=</span><span class="dv">4</span>)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>m[<span class="dv">1</span>,]<span class="ot">&lt;-</span><span class="fu">rowMeans</span>(test_result1)</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>m[<span class="dv">2</span>,]<span class="ot">&lt;-</span><span class="fu">rowMeans</span>(test_result2)</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>m[<span class="dv">3</span>,]<span class="ot">&lt;-</span><span class="fu">rowMeans</span>(test_result3)</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(m) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;scenario 1&quot;</span>,<span class="st">&quot;scenario 2&quot;</span>,<span class="st">&quot;scenario 3&quot;</span>)</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(m) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(n)</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">round</span>(m,<span class="dv">5</span>),<span class="at">caption=</span><span class="st">&quot;Type I error&quot;</span>)</span></code></pre></div>
<table>
<caption>
Type I error
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
20
</th>
<th style="text-align:right;">
50
</th>
<th style="text-align:right;">
100
</th>
<th style="text-align:right;">
200
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
scenario 1
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.05
</td>
</tr>
<tr>
<td style="text-align:left;">
scenario 2
</td>
<td style="text-align:right;">
0.44
</td>
<td style="text-align:right;">
0.67
</td>
<td style="text-align:right;">
0.72
</td>
<td style="text-align:right;">
0.76
</td>
</tr>
<tr>
<td style="text-align:left;">
scenario 3
</td>
<td style="text-align:right;">
0.60
</td>
<td style="text-align:right;">
0.82
</td>
<td style="text-align:right;">
0.83
</td>
<td style="text-align:right;">
0.87
</td>
</tr>
</tbody>
</table>
<p>From the table, we find that type I error can be controlled in
scenario 1 (<span class="math inline">\(\alpha=\beta=0\)</span>) but
fail for scenario 2,3 because in these scenarios taking <span class="math inline">\(T=\hat{a}\hat{b}\)</span> doesn’t make sence.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clean up the memory</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##           used (Mb) gc trigger (Mb) max used (Mb)
## Ncells  929698 49.7    1586426 84.8  1586426 84.8
## Vcells 1662525 12.7    8430941 64.4  8430941 64.4</code></pre>
</div>
<div id="exercise-2" class="section level3">
<h3>Exercise 2</h3>
<p><strong>Solution</strong></p>
<p>We use ‘cal_alpha’ to calculate <span class="math inline">\(\alpha\)</span>.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha,N,b1,b2,b3,f0){</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>alpha<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3)</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>tmp)</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(p)<span class="sc">-</span>f0</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>cal_alpha <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">N=</span><span class="fl">1e6</span>,<span class="at">b1=</span><span class="dv">0</span>,<span class="at">b2=</span><span class="dv">1</span>,<span class="at">b3=</span><span class="sc">-</span><span class="dv">1</span>,f0){</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">uniroot</span>(g,<span class="fu">c</span>(<span class="sc">-</span><span class="dv">12</span>,<span class="dv">0</span>),<span class="at">N=</span>N,<span class="at">b1=</span>b1,<span class="at">b2=</span>b2,<span class="at">b3=</span>b3,<span class="at">f0=</span>f0)<span class="sc">$</span>root</span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now we generate data.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">225</span>)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="fl">1e6</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N,<span class="dv">1</span>)</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(N,<span class="dv">1</span>)</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N,<span class="dv">1</span>,<span class="fl">0.5</span>)</span></code></pre></div>
<p>We calculate <span class="math inline">\(\alpha\)</span> for <span class="math inline">\(f_0=0.1,0.01,0.001,0.0001\)</span>.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>f0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>,<span class="fl">0.0001</span>)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="cf">function</span>(i) <span class="fu">cal_alpha</span>(<span class="fl">1e6</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,f0[i]))</span></code></pre></div>
<p>We plot <span class="math inline">\(\alpha-\log(f_0)\)</span>:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="fu">log</span>(f0),<span class="at">y=</span>alpha)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the scatter plot, we find that <span class="math inline">\(\alpha\propto\log(f_0)\)</span> .</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clean up the memory</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##           used (Mb) gc trigger (Mb) max used (Mb)
## Ncells  931428 49.8    1586426 84.8  1586426 84.8
## Vcells 1668114 12.8    8430941 64.4  8430941 64.4</code></pre>
</div>
</div>
<div id="hw9-1111" class="section level2">
<h2>HW9-1111</h2>
<div id="class-work" class="section level3">
<h3>Class Work</h3>
<p><strong>Problem.</strong></p>
<p>Suppose <span class="math inline">\(X_1,\dots, X_n \sim
Exp(\lambda),i.i.d.\)</span> We don’t know the exact value of <span class="math inline">\(X_i\)</span>. The only thing we know is that <span class="math inline">\(X_i \in (u_i,v_i)\)</span> where <span class="math inline">\(u_i,v_i\)</span> are constants. These data is
called interval-censored data.</p>
<p>(1)Maximizing the likelihood of observed data and taking EM procedure
to obtain the MLE of <span class="math inline">\(\lambda\)</span>
separately. Prove that <span class="math inline">\(\hat{\lambda}_{MLE}\)</span>s obtained from these
two methods are equal.</p>
<p>(2)Suppose the observations of <span class="math inline">\((u_i,v_i)\)</span>,<span class="math inline">\(i=1,\dots,n(=10)\)</span> are <span class="math inline">\((11,12),(8,9),(27,28),(13,14),(16,17),(0,1),(23,24),(10,11),(24,25),(2,3).\)</span>
Coding to obtain <span class="math inline">\(\hat{\lambda}_{MLE}\)</span> use the above
methods.</p>
<p><strong>Solution.</strong></p>
<p>(1)Denote <span class="math inline">\(\mathcal{D}=\{(u_i,v_i),i=1,\dots,n\}\)</span>.
The observed data log-likelihood is</p>
<p><span class="math display">\[\begin{align*}
L(\lambda|\mathcal{D})=&amp;\prod_{i=1}^nP(u_i&lt;X_i&lt;v_i)=\prod_i
(e^{-\lambda u_i}-e^{-\lambda v_i}),\\
l(\lambda|\mathcal{D})=&amp;\log L=\sum_i \log(e^{-\lambda
u_i}-e^{-\lambda v_i}),\\
\text{Let } \frac{\partial l}{\partial \lambda}=&amp;0, \text{we have
}\\
\sum_{i=1}^n&amp;\frac{u_ie^{-\lambda u_i}-v_ie^{-\lambda
v_i}}{e^{-\lambda u_i}-e^{-\lambda v_i}}=0.\quad (1)
\end{align*}\]</span></p>
<p>In EM procedure, the full log-likelihood is <span class="math display">\[\begin{aligned}
l(\lambda|\mathcal{D},X_1,\dots,&amp;X_n)=n\log \lambda-\lambda\sum_i
X_i,\\
E_{\lambda_0}[X_i|\mathcal{D}]&amp;=E_{\lambda_0}[X_i|u_i&lt;X_i&lt;v_i]\\
&amp;=\frac{E_{\lambda_0}[X_i]-P_{\lambda_0}(X_i\leq
u_i)E_{\lambda_0}[X_i|X_i\leq u_i]-P_{\lambda_0}(X_i\geq
v_i)E_{\lambda_0}[X_i|X_i\geq v_i]}{P_{\lambda_0}(u_i&lt;X_i&lt;v_i)}\\
&amp;=\frac{1}{\lambda}+\frac{u_ie^{-\lambda_0 u_i}-v_ie^{-\lambda_0
v_i}}{e^{-\lambda_0 u_i}-e^{-\lambda_0 v_i}},\\
\text{then the E-step }&amp;\text{will be}\\
Q(\lambda|\lambda_0)&amp;=E_{\lambda_0}[l(\lambda|\mathcal{D},X_1,\dots,X_n)|\mathcal{D}]\\
&amp;=n\log
\lambda-\lambda\left(\frac{n}{\lambda_0}-\sum_i\frac{u_ie^{-\lambda_0
u_i}-v_ie^{-\lambda_0 v_i}}{e^{-\lambda_0 u_i}-e^{-\lambda_0
v_i}}\right),\\
\text{let }\frac{\partial Q}{\partial \lambda}=0,\text{we}&amp;\text{
have}\\
\frac{n}{\lambda}-\frac{n}{\lambda_0}-&amp;\sum_i\frac{u_ie^{-\lambda_0
u_i}-v_ie^{-\lambda_0 v_i}}{e^{-\lambda_0 u_i}-e^{-\lambda_0 v_i}}=0,\\
\text{then the iteration step will be}\\
\lambda_{k+1}&amp;=n\left(\frac{n}{\lambda_k}+\sum_i\frac{u_ie^{-\lambda_k
u_i}-v_ie^{-\lambda_k v_i}}{e^{-\lambda_k u_i}-e^{-\lambda_k
v_i}}\right)^{-1},\quad (2)\\
\text{let }k\to\infty, \text{then } \lambda_{\infty} \text{
satisify}&amp; (1).\\
\end{aligned}\]</span></p>
<p>Then we proove that the solution of (1) is unique.</p>
<p>Denote <span class="math inline">\(g(\lambda)=\sum_{i=1}^n\frac{u_ie^{-\lambda
u_i}-v_ie^{-\lambda v_i}}{e^{-\lambda u_i}-e^{-\lambda v_i}}\)</span>,
then <span class="math display">\[g&#39;(\lambda)=-\sum_i\frac{(u_i-v_i)^2e^{-\lambda(u_i+v_i)}}{(e^{-\lambda
u_i}-e^{-\lambda v_i})^2}&gt;
0\]</span> Because <span class="math inline">\(\lim_{\lambda\to
0^+}g(\lambda)=-\infty,\lim_{\lambda\to
-\infty}g(\lambda)=+\infty\)</span>, <span class="math inline">\(g(\lambda)\)</span> have unique zero point. So
<span class="math inline">\(\hat{\lambda}_{MLE}\)</span>s obtained from
MLE and EM method are equal.</p>
<p>(2)We use function ‘dll’ to calculate <span class="math inline">\(g(\lambda)\)</span>. Solving <span class="math inline">\(g(\lambda)=0\)</span> we obtain <span class="math inline">\(\hat{\lambda}_{MLE}\)</span></p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>dll<span class="ot">&lt;-</span><span class="cf">function</span>(lambda,u,v){</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>((u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">-</span>v<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v)))</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># u[i]&lt;X_i&lt;v[i]</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">9</span>,<span class="dv">28</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">1</span>,<span class="dv">24</span>,<span class="dv">11</span>,<span class="dv">25</span>,<span class="dv">3</span>)</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>dll_root <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(dll,<span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.5</span>),<span class="at">u=</span>u,<span class="at">v=</span>v,<span class="at">tol=</span><span class="fl">1e-7</span>)</span></code></pre></div>
<p><span class="math inline">\(\hat{\lambda}_{MLE}\)</span> is</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>dll_root<span class="sc">$</span>root</span></code></pre></div>
<pre><code>## [1] 0.07197351</code></pre>
<p>Then we use EM method to obtain <span class="math inline">\(\hat{\lambda}_{EM}\)</span>, the MLE for <span class="math inline">\(\lambda\)</span> through EM method. We update
<span class="math inline">\(\hat{\lambda}_k\)</span> using (2).</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(u)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fl">0.05</span> <span class="co"># initial value</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>lambda1 <span class="ot">&lt;-</span> n<span class="sc">/</span>(n<span class="sc">/</span>lambda<span class="sc">+</span><span class="fu">dll</span>(lambda,u,v))</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(<span class="fu">abs</span>(lambda1<span class="sc">-</span>lambda)<span class="sc">&gt;</span><span class="fl">1e-7</span>){</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> lambda1</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>  lambda1 <span class="ot">&lt;-</span> n<span class="sc">/</span>(n<span class="sc">/</span>lambda<span class="sc">+</span><span class="fu">dll</span>(lambda,u,v))</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The <span class="math inline">\(\hat{\lambda}_{EM}\)</span> is</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>lambda1</span></code></pre></div>
<pre><code>## [1] 0.0719735</code></pre>
<p>We can find that the MLE of <span class="math inline">\(\lambda\)</span> obtained by likelihood and EM
method is the same.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clean up the memory</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##           used (Mb) gc trigger (Mb) max used (Mb)
## Ncells  931600 49.8    1586426 84.8  1586426 84.8
## Vcells 1669084 12.8    8430941 64.4  8430941 64.4</code></pre>
</div>
<div id="exercise-2.1.3" class="section level3">
<h3>Exercise 2.1.3</h3>
<p><strong>Problem 4</strong></p>
<p>Why do you need to use unlist() to convert a list to an atomic
vector? Why doesn’t as.vector() work?</p>
<p><strong>Solution</strong></p>
<p>Because ‘as.vector()’ attempts to coerce its argument in to a vector
of mode ‘mode’(the default is to coerce to whichever vector mode is most
convenient). In this meaning, a list is already a vector. So we need to
use ‘unlist()’. Let’s see an example.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">list</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(a)</span></code></pre></div>
<pre><code>## [1] &quot;list&quot;</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unlist</span>(a)</span></code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.vector</span>(a)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1
## 
## [[2]]
## [1] 2
## 
## [[3]]
## [1] 3</code></pre>
<p>We find that we obtain an integer vector using ‘unlist()’ and a list
using ‘as.vector’. Because the default parameter ‘m’ in ‘as.vector()’ is
“any” and a list is already a vector of some mode. Besides, we can set
‘m’=“integer”. Then we will obtain an integer vector.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.vector</span>(a,<span class="at">mode=</span><span class="st">&quot;integer&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clean up the memory</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##           used (Mb) gc trigger (Mb) max used (Mb)
## Ncells  931597 49.8    1586426 84.8  1586426 84.8
## Vcells 1669119 12.8    8430941 64.4  8430941 64.4</code></pre>
<p><strong>Problem 5</strong></p>
<p>Why is 1 == “1” true? Why is -1 &lt; FALSE true? Why is “one” &lt; 2
false?</p>
<p><strong>Solution</strong></p>
<p>When we use “==”,“&lt;”,“&gt;” to compare two atomic element of
different type, these two elements will be coerced to the most flexible
type.T ypes from least to most flexible are: logical, integer, double,
and character.</p>
<p>For 1==“1”, we actually consider whether “1”==“1” so the result is
true.</p>
<p>For -1&lt;FALSE, we actually consider whether -1&lt;0 so the result
is true.</p>
<p>For “one” &lt;2, we actually consider whether “one”&lt;“2” so the
result is false.</p>
</div>
<div id="exercise-2.3.1" class="section level3">
<h3>Exercise 2.3.1</h3>
<p><strong>Problem 1</strong></p>
<p>What does dim() return when applied to a vector?</p>
<p><strong>Solution</strong></p>
<p>dim() returns ‘NULL’ when applied to a vector</p>
<p><strong>Problem 2</strong></p>
<p>If is.matrix(x) is TRUE, what will is.array(x) return?</p>
<p><strong>Solution</strong></p>
<p>is.array(x) will return TRUE. Because matrix is a special type of
array.</p>
</div>
<div id="exercise-2.4.5" class="section level3">
<h3>Exercise 2.4.5</h3>
<p><strong>Problem 1</strong></p>
<p>What attributes does a data frame possess?</p>
<p><strong>Solution</strong></p>
<p>Data frames have a dimension attribute. Data frames can also have
additional attributes such as row names and column names.</p>
<p><strong>Problem 2</strong></p>
<p>What does as.matrix() do when applied to a data frame with columns of
different types?</p>
<p><strong>Solution</strong></p>
<p>The result depends on the types of the input columns.</p>
<p>In ‘as.matrix()’, the method for data frames will return a character
matrix if there is only atomic columns and any
non-(numeric/logical/complex) column, applying as.vector to factors and
format to other non-character columns. Otherwise, the usual coercion
hierarchy (logical &lt; integer &lt; double &lt; complex) will be used,
e.g., all-logical data frames will be coerced to a logical matrix, mixed
logical-integer will give a integer matrix, etc.</p>
<p><strong>Problem 3</strong></p>
<p>Can you have a data frame with 0 rows? What about 0 columns?</p>
<p><strong>Solution</strong></p>
<p>Yes.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">a=</span><span class="fu">integer</span>(),<span class="at">b=</span><span class="fu">logical</span>())</span></code></pre></div>
<pre><code>## [1] a b
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<p>In this way we create a data frame with 0 rows.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>))</span></code></pre></div>
<pre><code>## data frame with 0 columns and 3 rows</code></pre>
<p>In this way we create a data frame with 0 cols and 3 rows.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clean up the memory</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##           used (Mb) gc trigger (Mb) max used (Mb)
## Ncells  932119 49.8    1586426 84.8  1586426 84.8
## Vcells 1670540 12.8    8430941 64.4  8430941 64.4</code></pre>
</div>
</div>
<div id="hw10-1118" class="section level2">
<h2>HW10-1118</h2>
<div id="exercise-1-1" class="section level3">
<h3>Exercise 1</h3>
<p><strong>Problem.</strong></p>
<p>The function below scales a vector so it falls in the range [0, 1].
How would you apply it to every column of a data frame? How would you
apply it to every numeric column in a data frame?</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>  (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Solution.</strong></p>
<p>This function needs numeric input. So when call column of a data
frame is numeric, we can use ‘lapply’.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">6</span>,<span class="sc">-</span><span class="dv">5</span>),<span class="at">b=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">10</span>))</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">lapply</span>(df,scale01))</span></code></pre></div>
<pre><code>##           a     b
## 1 0.5454545 0.000
## 2 0.5909091 0.125
## 3 1.0000000 0.375
## 4 0.0000000 1.000</code></pre>
<p>When we need to apply the function to numeric columns in a data
frame, we can use ‘lapply’ and ‘if else’.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">6</span>,<span class="sc">-</span><span class="dv">5</span>),<span class="at">b=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">10</span>), <span class="at">c=</span><span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>))</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">lapply</span>(df,<span class="cf">function</span>(x) <span class="cf">if</span>(<span class="fu">is.numeric</span>(x)) <span class="fu">scale01</span>(x) <span class="cf">else</span> x))</span></code></pre></div>
<pre><code>##           a     b c
## 1 0.5454545 0.000 a
## 2 0.5909091 0.125 b
## 3 1.0000000 0.375 c
## 4 0.0000000 1.000 d</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clean up the memory</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##           used (Mb) gc trigger (Mb) max used (Mb)
## Ncells  932301 49.8    1586426 84.8  1586426 84.8
## Vcells 1672020 12.8    8430941 64.4  8430941 64.4</code></pre>
</div>
<div id="exercise-2-1" class="section level3">
<h3>Exercise 2</h3>
<p><strong>Problem</strong></p>
<p>Use vapply() to:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Compute the standard deviation of every column in a numeric data
frame.</p></li>
<li><p>Compute the standard deviation of every numeric column in a mixed
data frame. (Hint: you’ll need to use vapply() twice.)</p></li>
</ol>
<p><strong>Solution</strong></p>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="at">b=</span><span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>,<span class="at">c=</span><span class="sc">-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(df,sd,<span class="dv">0</span>)</span></code></pre></div>
<pre><code>##        a        b        c 
## 1.581139 1.581139 1.581139</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>d <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;e&quot;</span>) <span class="co"># now df is a mixed data frame</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(df[<span class="fu">vapply</span>(df,is.numeric,<span class="fu">logical</span>(<span class="dv">1</span>))],sd,<span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##        a        b        c 
## 1.581139 1.581139 1.581139</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clean up the memory</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##           used (Mb) gc trigger (Mb) max used (Mb)
## Ncells  932296 49.8    1586426 84.8  1586426 84.8
## Vcells 1672073 12.8    8430941 64.4  8430941 64.4</code></pre>
</div>
<div id="exercise-3" class="section level3">
<h3>Exercise 3</h3>
<p><strong>Problem</strong></p>
<p>Implement a Gibbs sampler to generate a bivariate normal chain <span class="math inline">\((X_t, Y_t)\)</span> with zero means, unit standard
deviations, and correlation 0.9.</p>
<p>• Write an Rcpp function.</p>
<p>• Compare the corresponding generated random numbers with pure R
language using the function “qqplot”.</p>
<p>• Compare the computation time of the two functions with the function
“microbenchmark”.</p>
<p><strong>Solution</strong></p>
<p>‘gibs’ generates a bivariate normal chain using pure R language.
‘gib_c’ generates a bivariate normal chain using Rcpp.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>gibs <span class="ot">&lt;-</span> <span class="cf">function</span>(s0,<span class="at">N=</span><span class="dv">1000</span>, <span class="at">b=</span><span class="dv">100</span>, <span class="at">cor=</span><span class="fl">0.9</span>){</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># N the length of chain</span></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># b burn length</span></span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># s0 initial state</span></span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>  ss <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span>N,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>  ss[<span class="dv">1</span>,] <span class="ot">&lt;-</span> s0</span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>  sdc <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>cor<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a>    ss[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.9</span><span class="sc">*</span>ss[i<span class="dv">-1</span>,<span class="dv">2</span>],sdc)</span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a>    ss[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.9</span><span class="sc">*</span>ss[i,<span class="dv">1</span>],sdc)</span>
<span id="cb167-12"><a href="#cb167-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb167-13"><a href="#cb167-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ss)</span>
<span id="cb167-14"><a href="#cb167-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb167-15"><a href="#cb167-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-16"><a href="#cb167-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&#39;NumericMatrix gib_c(NumericVector s0, int N, int b, double cor) {</span></span>
<span id="cb167-17"><a href="#cb167-17" aria-hidden="true" tabindex="-1"></a><span class="st">  NumericMatrix ss(N,2);</span></span>
<span id="cb167-18"><a href="#cb167-18" aria-hidden="true" tabindex="-1"></a><span class="st">  ss(0,0) = s0[0];</span></span>
<span id="cb167-19"><a href="#cb167-19" aria-hidden="true" tabindex="-1"></a><span class="st">  ss(0,1) = s0[1];</span></span>
<span id="cb167-20"><a href="#cb167-20" aria-hidden="true" tabindex="-1"></a><span class="st">  double sdc = sqrt(1-cor*cor);</span></span>
<span id="cb167-21"><a href="#cb167-21" aria-hidden="true" tabindex="-1"></a><span class="st">  for(int i=1; i&lt;N; i++){</span></span>
<span id="cb167-22"><a href="#cb167-22" aria-hidden="true" tabindex="-1"></a><span class="st">    ss(i,0) = rnorm(1,0.9*ss(i-1,1),sdc)[0];</span></span>
<span id="cb167-23"><a href="#cb167-23" aria-hidden="true" tabindex="-1"></a><span class="st">    ss(i,1) = rnorm(1,0.9*ss(i,0),sdc)[0];</span></span>
<span id="cb167-24"><a href="#cb167-24" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb167-25"><a href="#cb167-25" aria-hidden="true" tabindex="-1"></a><span class="st">  return ss;</span></span>
<span id="cb167-26"><a href="#cb167-26" aria-hidden="true" tabindex="-1"></a><span class="st">}&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1596</span>)</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>r_mc <span class="ot">&lt;-</span> <span class="fu">gibs</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1989</span>)</span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>c_mc <span class="ot">&lt;-</span> <span class="fu">gib_c</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="dv">1000</span>,<span class="dv">100</span>,<span class="fl">0.9</span>)</span></code></pre></div>
<p>Leaving out the burn-in samples, we compare r_mc and c_mc using
‘qqplot’.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(r_mc[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,<span class="dv">1</span>],c_mc[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,<span class="dv">1</span>],<span class="at">main=</span><span class="st">&quot;X_t&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;X__t in R&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;X_t in C&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAdVBMVEUAAAAAADoAAGYAOmYAOpAAZrY6AAA6ADo6AGY6OpA6kNtmAABmADpmOgBmZjpmZrZmkJBmtrZmtv+QOgCQOjqQ2/+2ZgC2Zjq2Zma2ZpC2tpC22/+2///bkDrb2//b/7bb////tmb/25D/27b//7b//9v///+f3auSAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIlElEQVR4nO2dC5ujNBSGs+tu1amuOqN4W3SoLf//J9oQoLQkfJyQwGn7vc9jZ+xAkr6bG3CamJpMYrYugHYoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAggEpBh535+HXw88Lpz6/+U7KhUlBdGvP5bOPNmNer9//78SMFWZwap2lIcVuj8qNTUNO4/ho1sMKcWVmRUkG29pjbBkZBA477s4tP7zfvsoldqIz58NvtmxTUY7tp83L7LgX1NH3QqApRUMe5C/rwZdwJUVDHebx6sa3s5fZtCmqomspzngzdNLLS03FnRqUg28CsiPK2kVWcBzUU7TXGqJGdfjfmm79XLYtKQZqgIIB6QZXpWb2DtlAQQL2graEgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBEgsyd8NWgtIml4HWDQUFMIP/Zp+QOH/NmO6VgvysIsj7LYr45FYltyAb3334/r0+7l/9B6gXZEzOPqj49F4XLoJ59E2liOTWx+QdxZp6c/jWCqquw7nl04v16UuXU5CN6j79U99RDer/zS7tKuM8qOzqjVO1NLkV6LW4l8GvkhTmU7rhq7r9Mmlkctm5VBnfb4IkEpdIDaZpYgMtVy1uZhKJS6QKN6r3bWpQOgqyuOpj+toz/NPsNBIXKW1yyzBu+uEtFAXVbY9DQWFMZ8j3t9mJpCtPhuQW0erxF4mC6lYPBQXoRrBAiZ5eUNf/UFAAdHvhyQXh2y/PLGjW06+VBWm6YTbv8eDz1qCZz0+fVVA/dqH6/KSC5j9/Fws6vdnlRA67wK1UaXLbMN+PWNBx7+7Cdz+ji7jk5MXMtVPLBRWdl+DteFFyGyEYTIWCTm+9ltADHUly2zC/+tRiQYNHydWiFZ42FCSbi4kFXWrQnQoSzlXFfVC/7G5xj01M0Dt3Z8xO2v047F5vfoljG0FyP/J5UOVWUyvHy4OK2ELQ7LnP1UniA5vFU28XuBazgaAoP090qRHn53kERfp5GkGRejIJalYJbwnMllYWFKsnVw06vYW8xJZzEdHVp87WxNxNkWTJLWOBnihBbpwHq+2GY8uE+S5mSfWpowQVKdYhXk3QQj8RghbeCJLmuzCbpX6iBC26CJPmuyiT5X6iLjWWXmaI8o3PwaTwE9MHof43bb6x6afRE9fEpqeAifONTD6Rnge91EhWferHFJTSzwMKSqon5qa98j4orZ6Hq0GJ7dQPJii9nscSlEHPIwnKUX3q1QVl+ASjlNMmHjGT/sF9F17Vs/lM1adeIkjRs/nUQ/tV2sIDi0s51MQHZdSzpAatlC9OKaeehZ306ddoV6lmKTlbl8thyYGbC8qu574F5a8+9T0LWkXPHQtaR8/9ClrLz50KWk3PnQpazU6dSVDW8JcVa0+TXfyBf4SvxYLhL/J8Ryeuqkd+T/qn7v8PuykH2cJfVtYTcdO+XfgP7VeeI/xl5cbVZio88PRmI4APu8g44CUfbxM/EX1QZT58Wb4XrvzzbeMnMsJsXvUZfHcqPt/u+I38RAgqbQ2adTcxoaCN7NRyQecpzufmdcb9xGSCtqo9Td6yA2ePYpY0gjZrXG32sgPnzoMaEgja2E6dayadKt/t/eh+sqrAj2ZBGvQoFqRDj15BWvxoFaTETq1aUL29nVq1oKm16dZDpyAVjastSvIDUySnx4/OCDNFfnTWIC39j0WhIEUdUK1RkJ4BrEGdICXzwx5tgvTMEFv0CDJu5wa3uLwaP3oE2TcGerT4USPIdHZUta9akaCuBnWvWthU0GC4csmbyw4yWsgpCO1x2C+2b/oapKl7dmQSNGePQ9OKMRdVutw05BE0a4/DK0H1pZ3pIoug8B6Hw+SuBSnrm3syCZq1x+GwD1JLniY2c49DVRddATJ10qE9DpVdic5gs3nQ3ZBR0FR0x7y0J+4abZrW4oMdFASgIAAFASgoFRQUmzYFgbQpCKRNQQ8EBQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAuQUVE6EgQQ5fDd+qD0RT+I7vG63mfHe+JQWKqMg+xy2kho67sdP/W0igYR8h9fWz/nw0rdQgrhQ+QQ1j6elu3VUnpWJ3D3wwpeQ73CL28rSs+qqvFCZ+yChoMq8jONGgp/Wf/jgz4GaoklQKe6EPIKmAm6mBIW2cxIVKqugKmLp3PEndhUhUB0mBFX+zIWFyt7EpBv/JhNUBRezERUq9zxIPIylamKB+iMuVBZB5WUSMndr5P4USSftPbxLb6IdSfZrzleDXCnEK8CPT5gY5oPpl4G11uSFytjEbEzs7Of4PZ7CT0wUA5/1sAtlKy5Uzj7IrgMv3rPM94knLg/8gkoXReY7SVooXqwCKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQANgg47F9DkD8mo3Ju3y6Y1gb6hWN+EaBDUBjv5QzJC68m1kZhoT8HFqBDUhFsGYk+BIGmcsRgdgo77z4EQssPOmKYBWlHH/S/7LnilM1NIgyCF6BB09vBzICyuq0FOkA2gd1E/z1WDJmIKrwW99AGGrZlQrF0ylAg6j0mBuMFrQa/9G90oltmPFkHFp3/3/rYSFtRsDJu5gWkRZAfrQGDzpKDJaOg0qBDkKkLhDdScFhQ4KSEaBLWbkB/3vhG7W/QzIMh/UkIUCDp3t66S+L9dUQznQSNB0yH1CVAgSDcUBNAlyF5YXJO7D4boEqQQCgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFAT4HxuKjkX/1662AAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(r_mc[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,<span class="dv">2</span>],c_mc[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,<span class="dv">2</span>],<span class="at">main=</span><span class="st">&quot;Y_t&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Y__t in R&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Y_t in C&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the two qqplot, we find that ‘r_mc’ and ‘c_mc’ have the same
distribution. Then we compare their computation time.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">gibbsR=</span><span class="fu">gibs</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)), <span class="at">gibbsC=</span><span class="fu">gib_c</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="dv">1000</span>,<span class="dv">100</span>,<span class="fl">0.9</span>))</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##     expr     lq median      uq
## 1 gibbsR 2846.1 2917.0 3381.25
## 2 gibbsC  218.2  223.7  231.05</code></pre>
<p>Gibbs in C is much faster than it in R.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clean up the memory</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##           used (Mb) gc trigger (Mb) max used (Mb)
## Ncells  951163 50.8    1586426 84.8  1586426 84.8
## Vcells 1714721 13.1    8430941 64.4  8430941 64.4</code></pre>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
